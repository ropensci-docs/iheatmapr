<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="iheatmapr">
<title> • iheatmapr</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="iheatmapr">
<meta property="og:image" content="https://docs.ropensci.org/iheatmapr/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../../index.html">iheatmapr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../../articles/full_vignettes/iheatmapr.html">Vignette</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/full_vignettes/iheatmapr.html">UNKNOWN TITLE</a>
    <a class="dropdown-item" href="../../articles/iheatmapr-minimal.html">Minimal iheatmpar vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/iheatmapr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="iheatmapr_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="iheatmapr_files/iheatmapr-binding-0.7.0/iheatmapr.js"></script><script src="iheatmapr_files/plotly-2.10.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/iheatmapr/blob/HEAD/vignettes/full_vignettes/iheatmapr.Rmd" class="external-link"><code>vignettes/full_vignettes/iheatmapr.Rmd</code></a></small>
      <div class="d-none name"><code>iheatmapr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>iheatmapr</code> is an R package for building complex, interactive heatmaps using modular building blocks. “Complex” heatmaps are heatmaps in which subplots along the rows or columns of the main heatmap add more information about each row or column. For example, a one column additional heatmap may indicate what group a particular row or column belongs to. Complex heatmaps may also include multiple side by side heatmaps which show different types of data for the same conditions. Interactivity can improve complex heatmaps by providing tooltips with information about each cell and enabling zooming into interesting features.</p>
<p>While there are already plenty of awesome R packages for making heatmaps, including several great packages for making relatively simple interactive heatmaps (<a href="https://github.com/talgalili/heatmaply" class="external-link">heatmaply</a> and <a href="https://github.com/rstudio/d3heatmap" class="external-link">d3heatmap</a>) or complex static heatmaps (<a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a>), <code>iheatmapr</code> seeks to make it easy to make complex interactive heatmaps.</p>
<p>For this vignette, we will use the Indometh data included in the datasets package. This data set contains data on the pharmacokinetics of Indometacin, specifically the observed plasma concentration of indometacin at various time points after intravenous injection for 6 different patients. We will first cast the data into a matrix of concentrations by patients (rows) and time (columns). We will also compute correlation matrices for the patients, and the maximum and minimum concentration of Indometacin per patient. Finally, we will assign patients into some groups – in this dataset no extra patient information is provided and so we’ll just make arbitrary groups that are intended to show how one might use actual groupings like gender or ethnicity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/iheatmapr">iheatmapr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Indometh_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">acast</a></span><span class="op">(</span><span class="va">Indometh</span>, <span class="va">Subject</span> <span class="op">~</span> <span class="va">time</span>, value.var <span class="op">=</span> <span class="st">"conc"</span><span class="op">)</span></span>
<span><span class="va">Indometh_matrix</span> <span class="op">&lt;-</span> <span class="va">Indometh_matrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Patient"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Indometh_patient_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patient_max_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,<span class="fl">1</span>,<span class="va">max</span><span class="op">)</span></span>
<span><span class="va">patient_min_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,<span class="fl">1</span>,<span class="va">min</span><span class="op">)</span></span>
<span><span class="va">patient_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span><span class="op">)</span> <span class="co"># Arbitrary groups</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-complex-heatmap">Example Complex Heatmap<a class="anchor" aria-label="anchor" href="#example-complex-heatmap"></a>
</h3>
<p>We will start off by showing an example of the type of complex heatmap we can create using the <code>iheatmapr</code> package. In our example complex heatmap, we will plot:</p>
<ul>
<li>a heatmap of the correlation matrix</li>
<li>a dendrogram for column clustering</li>
<li>a dendrogram for row clustering as well as annotation heatmap showing 3 clusters</li>
<li>annotation heatmaps showing the max and min Indometacin concentrations per patient</li>
<li>annotation heatmap showing whether patients fall in group “A” or “B”</li>
<li>a heatmap showing the actual Indometacin timecourse data for each patient</li>
<li>a plot showing the average Indometacin timecourse response</li>
<li>titles and labels for heatmaps</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>,name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_clustering.html">add_col_clustering</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_title.html">add_row_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_title.html">add_col_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>                   name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_labels.html">add_col_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_title.html">add_col_title</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-84d337e49e7dca379196" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-84d337e49e7dca379196">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 5<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"z":[[2.0299999999999998],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001],[1.5],[2.7200000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"],["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.28688524590163939,"#BDE6DD"],[0.43442622950819648,"#81CEB7"],[0.45081967213114732,"#7BCBB2"],[0.66393442622950816,"#38A367"],[1,"#00441B"]],"xaxis":"x5","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997],[0.050000000000000003],[0.080000000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"],["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.24999999999999992,"#FED976"],[0.50000000000000022,"#FD8D3C"],[0.75000000000000011,"#E31A1C"],[1,"#800026"]],"xaxis":"x6","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"],["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x7","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.0037453183520599225,"#FEF7FB"],[0.0074906367041198503,"#FEF6FA"],[0.011235955056179773,"#FDF6FA"],[0.014981273408239695,"#FDF5FA"],[0.018726591760299623,"#FCF5FA"],[0.022471910112359546,"#FCF4F9"],[0.02621722846441947,"#FBF4F9"],[0.029962546816479398,"#FAF3F9"],[0.041198501872659173,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.052434456928838948,"#F7F0F7"],[0.056179775280898875,"#F6F0F7"],[0.063670411985018716,"#F5EFF6"],[0.067415730337078636,"#F5EEF6"],[0.07116104868913857,"#F4EEF6"],[0.074906367041198491,"#F4EDF6"],[0.09363295880149812,"#F1EBF4"],[0.10112359550561797,"#F0EAF4"],[0.11610486891385766,"#EDE8F3"],[0.11985018726591759,"#EDE8F2"],[0.12734082397003743,"#EBE7F2"],[0.13108614232209737,"#EBE6F1"],[0.13857677902621721,"#E9E5F1"],[0.16104868913857676,"#E4E1EF"],[0.20224719101123589,"#DBD9EB"],[0.22097378277153554,"#D6D6E9"],[0.24344569288389506,"#D1D2E7"],[0.24719101123595499,"#D1D1E6"],[0.27340823970037448,"#C8CDE4"],[0.28089887640449435,"#C6CCE3"],[0.28464419475655428,"#C5CBE3"],[0.29588014981273403,"#C1CAE2"],[0.31460674157303364,"#BBC7E0"],[0.33333333333333326,"#B4C4DF"],[0.36329588014981268,"#AABFDC"],[0.36704119850187261,"#A9BEDC"],[0.37078651685393255,"#A7BEDB"],[0.41573033707865159,"#96B6D7"],[0.50187265917602986,"#73A9CF"],[0.52059925093632953,"#6BA5CD"],[0.53932584269662909,"#63A1CA"],[0.54307116104868902,"#62A0CA"],[0.59176029962546806,"#4A97C4"],[0.67415730337078639,"#2983BA"],[0.74157303370786498,"#0C72B1"],[0.74906367041198485,"#0670B0"],[0.84644194756554303,"#045F95"],[1,"#023858"]],"xaxis":"x8","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x8","yaxis":"y6","showlegend":false,"type":"scatter"}],"layout":{"xaxis4":{"domain":[0,0.03937007874015748],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis3":{"domain":[0.043307086614173172,0.10236220472440939],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.10433070866141721,0.12401574803149594],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.12598425196850382,0.51968503937007859],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis5":{"domain":[0.52559055118110221,0.54527559055118113],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.54822834645669272,0.56791338582677153],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.57086614173228334,0.59055118110236204],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.60629921259842523,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.1400651465798044,0.79153094462540707],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.79478827361563509,0.89250814332247541],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0.068403908794788262,0.13355048859934837],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0.071661237785016124,0.13680781758957639],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0,0.065146579804560095],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis6":{"domain":[0.80456026058631913,1],"anchor":"x8"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}}],"annotations":[{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x4","yref":"y"},{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x8","yref":"y5"}],"legend":{"x":1.53,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>All the plots aligned with the correlation heatmap horizontally share the same y axis and thus zooming in the y direction within the heatmap will also zoom in to those subplots. The plots aligned with either the correlation heatmap or the concentration heatmap vertically share an x axis with that heatmap and zooming horizontally within those plots will be linked.</p>
<p>Hovering over the heatmaps yields a tooltip with the name of the row and column as well as the value represented.</p>
</div>
<div class="section level3">
<h3 id="modular-system-for-building-up-complex-heatmaps">Modular system for building up complex heatmaps<a class="anchor" aria-label="anchor" href="#modular-system-for-building-up-complex-heatmaps"></a>
</h3>
<p>In our example complex heatmap above, the various components are added iteratively. There are two main types of plots in <code>iheatmapr</code>– “main heatmaps” and subplots. Subplots can be added to the left, right, top, or bottom of a main heatmap. We will go over the basics of adding together different components of a plot in this section, and the <a href="#modular-building-blocks">Modular buidling blocks</a> section of the vignette will go into detail into each of the modular components available.</p>
<div class="section level4">
<h4 id="starting-with-basic-heatmap">Starting with basic heatmap<a class="anchor" aria-label="anchor" href="#starting-with-basic-heatmap"></a>
</h4>
<p>To initialize a complex heatmap, we start off by making a very simple heatmap using the <code>main_heatmap</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-6748e85bcf1284408355" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-6748e85bcf1284408355">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="adding-subplots-to-right-or-left">Adding subplots to right or left<a class="anchor" aria-label="anchor" href="#adding-subplots-to-right-or-left"></a>
</h4>
<p>To this heatmap, we can add subplots to the top, bottom, left, or right. To illustrate how subplots are added we will start with one kind of subplot – annotation heatmaps. The function <code>add_row_annotation</code> adds annotation heatmap(s) to the side of a heatmap. These functions are most easily chained together using the <code>%&gt;%</code> operator from the magrittr package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-cc382ee34f0dda882624" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-cc382ee34f0dda882624">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.93896713615023475],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.95305164319248825,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>After adding one subplot to the right of a heatmap, we can easily add another. We can add as many subplots to any side of the heatmap as we want.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-ef940d6d50ef909304c2" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-ef940d6d50ef909304c2">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.88495575221238942],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.89823008849557517,0.94247787610619471],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.95575221238938057,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>We can also add the subplot to the left instead of the right by specifying <code>side = left</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-61f36b22ed7877fa2412" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-61f36b22ed7877fa2412">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.054393305439330519,0.89121338912133896],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.90376569037656895,0.94560669456066948],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.95815899581589958,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.041841004184100423],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="adding-subplot-to-top-or-bottom">Adding subplot to top or bottom<a class="anchor" aria-label="anchor" href="#adding-subplot-to-top-or-bottom"></a>
</h4>
<p>The analogous function add_col_annotation can be used for adding annotation heatmap(s) to the top or bottom of a heatmap. We will first add one to the top (default side).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_annotation.html">add_col_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-3aab8d9a23734ebbefcc" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-3aab8d9a23734ebbefcc">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.054393305439330519,0.89121338912133896],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.90376569037656895,0.94560669456066948],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.95815899581589958,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.041841004184100423],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,0.93896713615023475],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95305164319248825,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Now we add one to the bottom:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_annotation.html">add_col_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-a9cad1ddb7c8daa2b613" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-a9cad1ddb7c8daa2b613">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.054393305439330519,0.89121338912133896],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.90376569037656895,0.94560669456066948],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.95815899581589958,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0,0.041841004184100423],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0.057522123893805177,0.9424778761061946],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938046,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.044247787610619337],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>The axis titles seem to overlap a bit – to avoid this we can potentially alter the spacing between the plots – see <a href="#altering-plot-sizes-and-spacing">Altering plot sizes and spacing</a>.</p>
</div>
<div class="section level4">
<h4 id="additional-main-heatmaps">Additional main heatmaps<a class="anchor" aria-label="anchor" href="#additional-main-heatmaps"></a>
</h4>
<p>We can add another “main heatmap” using the <code>add_main_heatmap</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-3ae4be047516fe6488ed" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-3ae4be047516fe6488ed">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis4":{"domain":[0,0.022371364653243849],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.029082774049216987,0.47651006711409399],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.48322147651006708,0.50559284116331094],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.51230425055928408,0.53467561521252793],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.55257270693512295,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0.057522123893805177,0.9424778761061946],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938046,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.044247787610619337],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Once we’ve added another main heatmap, when we add a subplot to the top or bottom, by default it will go on top/bottom of the most recently added heatmap.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_heatmap</span> <span class="op">&lt;-</span> <span class="va">example_heatmap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_annotation.html">add_col_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_heatmap</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-2ae39667ceb037ffe31a" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-2ae39667ceb037ffe31a">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x3","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1],[1],[2],[1],[2],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x","yaxis":"y3","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1,1,2,1,2,1]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 1<br>Value: A","Row: Groups<br>Col: Patient 2<br>Value: A","Row: Groups<br>Col: Patient 3<br>Value: B","Row: Groups<br>Col: Patient 4<br>Value: A","Row: Groups<br>Col: Patient 5<br>Value: B","Row: Groups<br>Col: Patient 6<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x5","yaxis":"y4","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis4":{"domain":[0,0.022371364653243849],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.029082774049216987,0.47651006711409399],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.48322147651006708,0.50559284116331094],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.51230425055928408,0.53467561521252793],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.55257270693512295,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0.057522123893805177,0.9424778761061946],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95575221238938046,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis3":{"domain":[0,0.044247787610619337],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"yaxis4":{"domain":[0.95575221238938046,1],"anchor":"x5","anchor.1":"x5","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>To specify that we want to add the subplot to another main heatmap, the same “xname” argument can be passed both to the desired main heatmap and the subplot to be added.</p>
</div>
<div class="section level4">
<h4 id="row-and-column-ordering">Row and Column ordering<a class="anchor" aria-label="anchor" href="#row-and-column-ordering"></a>
</h4>
<p>When we initialize a heatmap using <code>main_heatmap</code> we can specify the row and/ or column order using the <code>row_order</code> and <code>col_order</code> arguments respectively. The functions <code>add_row_clustering</code> or <code>add_col_clustering</code> (See <a href="#add-clustering">Add clustering</a>) can also be used to order the rows or columns. When the row or column order is specified (either initially or through a later function), this ordering is carried through to all plots along the same axis.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-iheatmap-and-add_iheatmap-functions">The iheatmap and add_iheatmap functions<a class="anchor" aria-label="anchor" href="#the-iheatmap-and-add_iheatmap-functions"></a>
</h3>
<p>The <code>iheatmapr</code> package includes two functions, <code>iheatmap</code> and <code>add_iheatmap</code>, that wrap together several of the modular building blocks that are often used in conjunction to make common types of heatmaps. Rather than calling many of the modular functions individually, additional arguments can be passed to <code>iheatmap</code> or <code>add_iheatmap</code>. Not all modular subcomponents can be specified this way, but such components can still be added directly through their function calls (e.g. <code>add_col_summary</code>). The following code generates the same plot as our first example heatmap above:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>         cluster_cols <span class="op">=</span> <span class="st">"hclust"</span>, </span>
<span>         cluster_rows <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>         col_title <span class="op">=</span> <span class="st">"Patients"</span>,</span>
<span>         row_title <span class="op">=</span> <span class="st">"Patients"</span>,</span>
<span>         name <span class="op">=</span> <span class="st">"Correlation"</span>,</span>
<span>         row_k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>         row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                     <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                     <span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_iheatmap.html">add_iheatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>               name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span></span>
<span>               col_title <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>               col_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-465e8c1f9408efeb5f64" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-465e8c1f9408efeb5f64">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 5<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"z":[[2.0299999999999998],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001],[1.5],[2.7200000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"],["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.28688524590163939,"#BDE6DD"],[0.43442622950819648,"#81CEB7"],[0.45081967213114732,"#7BCBB2"],[0.66393442622950816,"#38A367"],[1,"#00441B"]],"xaxis":"x4","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997],[0.050000000000000003],[0.080000000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"],["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.24999999999999992,"#FED976"],[0.50000000000000022,"#FD8D3C"],[0.75000000000000011,"#E31A1C"],[1,"#800026"]],"xaxis":"x5","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"],["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x6","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.0037453183520599225,"#FEF7FB"],[0.0074906367041198503,"#FEF6FA"],[0.011235955056179773,"#FDF6FA"],[0.014981273408239695,"#FDF5FA"],[0.018726591760299623,"#FCF5FA"],[0.022471910112359546,"#FCF4F9"],[0.02621722846441947,"#FBF4F9"],[0.029962546816479398,"#FAF3F9"],[0.041198501872659173,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.052434456928838948,"#F7F0F7"],[0.056179775280898875,"#F6F0F7"],[0.063670411985018716,"#F5EFF6"],[0.067415730337078636,"#F5EEF6"],[0.07116104868913857,"#F4EEF6"],[0.074906367041198491,"#F4EDF6"],[0.09363295880149812,"#F1EBF4"],[0.10112359550561797,"#F0EAF4"],[0.11610486891385766,"#EDE8F3"],[0.11985018726591759,"#EDE8F2"],[0.12734082397003743,"#EBE7F2"],[0.13108614232209737,"#EBE6F1"],[0.13857677902621721,"#E9E5F1"],[0.16104868913857676,"#E4E1EF"],[0.20224719101123589,"#DBD9EB"],[0.22097378277153554,"#D6D6E9"],[0.24344569288389506,"#D1D2E7"],[0.24719101123595499,"#D1D1E6"],[0.27340823970037448,"#C8CDE4"],[0.28089887640449435,"#C6CCE3"],[0.28464419475655428,"#C5CBE3"],[0.29588014981273403,"#C1CAE2"],[0.31460674157303364,"#BBC7E0"],[0.33333333333333326,"#B4C4DF"],[0.36329588014981268,"#AABFDC"],[0.36704119850187261,"#A9BEDC"],[0.37078651685393255,"#A7BEDB"],[0.41573033707865159,"#96B6D7"],[0.50187265917602986,"#73A9CF"],[0.52059925093632953,"#6BA5CD"],[0.53932584269662909,"#63A1CA"],[0.54307116104868902,"#62A0CA"],[0.59176029962546806,"#4A97C4"],[0.67415730337078639,"#2983BA"],[0.74157303370786498,"#0C72B1"],[0.74906367041198485,"#0670B0"],[0.84644194756554303,"#045F95"],[1,"#023858"]],"xaxis":"x8","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x8","yaxis":"y6","showlegend":false,"type":"scatter"}],"layout":{"xaxis7":{"domain":[0,0.037037037037037042],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis3":{"domain":[0.040740740740740695,0.09629629629629631],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.098148148148148082,0.1166666666666666],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.1185185185185185,0.48888888888888887],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis4":{"domain":[0.49444444444444452,0.51296296296296306],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.51574074074074083,0.53425925925925932],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.53703703703703709,0.55555555555555558],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.62962962962962954,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.1400651465798044,0.79153094462540707],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.79478827361563509,0.89250814332247541],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0.068403908794788262,0.13355048859934837],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0.071661237785016124,0.13680781758957639],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0,0.065146579804560095],"anchor":"x8","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis6":{"domain":[0.80456026058631913,1],"anchor":"x8"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x7","yref":"y"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x8","yref":"y4","font":[],"yanchor":"top"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x8","yref":"y5"}],"legend":{"x":1.53,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>These functions can be useful for quickly creating a fairly standard plot. However, fewer options are available with <code>iheatmap</code> than if using each of the modular functions by themselves and there is much less flexibility in the ordering and sizing of the different subcomponents.</p>
</div>
<div class="section level3">
<h3 id="saving-plots">Saving plots<a class="anchor" aria-label="anchor" href="#saving-plots"></a>
</h3>
<p>The <code>save_iheatmap</code> function can be used to save an iheatmap object as a standalone html file or as a static pdf/png/jpeg.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>         cluster_cols <span class="op">=</span> <span class="st">"hclust"</span>, </span>
<span>         cluster_rows <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>         col_title <span class="op">=</span> <span class="st">"Patients"</span>,</span>
<span>         name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">myplot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/save_iheatmap.html">save_iheatmap</a></span><span class="op">(</span><span class="st">"myplot.html"</span><span class="op">)</span> <span class="co"># Save interactive HTML</span></span>
<span><span class="va">myplot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/save_iheatmap.html">save_iheatmap</a></span><span class="op">(</span><span class="st">"myplot.pdf"</span><span class="op">)</span> <span class="co"># Save static plot (pdf, png, or jpeg)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modular-building-blocks">Modular building blocks<a class="anchor" aria-label="anchor" href="#modular-building-blocks"></a>
</h2>
<p>In this section of the vignette, we will explore each of the modular components included in the <code>iheatmapr</code> package.</p>
<div class="section level3">
<h3 id="main-heatmap">Main heatmap<a class="anchor" aria-label="anchor" href="#main-heatmap"></a>
</h3>
<p>The <code>main_heatmap</code> function creates a basic heatmap. By default, the column and row names of the input matrix are used for determining the “Row” and “Column” labels in the tooltip above each cell.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>             name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-4af773fd38a803bd184e" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-4af773fd38a803bd184e">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Alternatively one can provide the “y” or “x” arguments to use different labels in the tooltip. Providing these arguments will also affect the row and column labels if those are added later (See <a href="#add-labels">Add labels</a>)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patient_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Patient "</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>             x <span class="op">=</span> <span class="va">patient_names</span>,</span>
<span>             y <span class="op">=</span> <span class="va">patient_names</span>,</span>
<span>             name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-c3f91c4cca72a5625bbd" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-c3f91c4cca72a5625bbd">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>To change the color use the “colors” argument with either the name of an RColorBrewer palette or a vector of colors:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>,</span>
<span>             colors <span class="op">=</span> <span class="st">"Blues"</span>,</span>
<span>             name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-7e32a9e2a636a3a9f47d" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-7e32a9e2a636a3a9f47d">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#F7FBFF"],[0.10001322008090581,"#E3EEF9"],[0.34910452905907791,"#A6CEE4"],[0.37119811264977309,"#9FCBE1"],[0.37395197912552347,"#9ECAE1"],[0.53909253288699133,"#5FA5D1"],[0.56926241893055463,"#569ECD"],[0.64310313396837959,"#3E8DC4"],[0.70811149009551233,"#2E7CBB"],[0.71010525201201313,"#2D7BBA"],[0.73292897545067415,"#2775B7"],[0.7829176416310073,"#1C68AE"],[0.85441089369701861,"#0E56A0"],[0.89680716587284326,"#084B93"],[0.92354394117748095,"#094489"],[1,"#08306B"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-main-heatmap">Add main heatmap<a class="anchor" aria-label="anchor" href="#add-main-heatmap"></a>
</h3>
<p>The <code>add_main_heatmap</code> function is very similar to the main heatmap function, it just adds a new main heatmap to the left or right of the existing plots.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-7f29dd8844a9ac2c2c88" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-7f29dd8844a9ac2c2c88">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#F7FCFD"],[0.0037453183520599225,"#F6FCFD"],[0.0074906367041198503,"#F6FCFD"],[0.011235955056179773,"#F5FBFD"],[0.014981273408239695,"#F5FBFD"],[0.018726591760299623,"#F4FBFC"],[0.022471910112359546,"#F4FBFC"],[0.02621722846441947,"#F3FBFC"],[0.029962546816479398,"#F3FAFC"],[0.041198501872659173,"#F1FAFC"],[0.0449438202247191,"#F1F9FC"],[0.052434456928838948,"#EFF9FB"],[0.056179775280898875,"#EFF9FB"],[0.063670411985018716,"#EEF8FB"],[0.067415730337078636,"#EDF8FB"],[0.07116104868913857,"#EDF8FB"],[0.074906367041198491,"#ECF8FB"],[0.09363295880149812,"#EAF7FA"],[0.10112359550561797,"#E8F6FA"],[0.11610486891385766,"#E6F5F9"],[0.11985018726591759,"#E6F5F9"],[0.12734082397003743,"#E5F5F9"],[0.13108614232209737,"#E4F5F8"],[0.13857677902621721,"#E2F4F7"],[0.16104868913857676,"#DEF2F3"],[0.20224719101123589,"#D6EFED"],[0.22097378277153554,"#D2EEEA"],[0.24344569288389506,"#CDECE7"],[0.24719101123595499,"#CDECE6"],[0.27340823970037448,"#C3E8E1"],[0.28089887640449435,"#C0E7DF"],[0.28464419475655428,"#BEE6DE"],[0.29588014981273403,"#BAE5DB"],[0.31460674157303364,"#B2E2D7"],[0.33333333333333326,"#AADFD3"],[0.36329588014981268,"#9EDACC"],[0.36704119850187261,"#9CD9CB"],[0.37078651685393255,"#9BD9CA"],[0.41573033707865159,"#89D1BD"],[0.50187265917602986,"#65C2A3"],[0.52059925093632953,"#60BF9C"],[0.53932584269662909,"#5BBC95"],[0.54307116104868902,"#5ABB94"],[0.59176029962546806,"#4CB382"],[0.67415730337078639,"#36A063"],[0.74157303370786498,"#258D48"],[0.74906367041198485,"#238B45"],[0.84644194756554303,"#0A7432"],[1,"#00441B"]],"xaxis":"x2","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,0.49019607843137253],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.50980392156862742,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Note that if the same “name” argument is given to both the first main heatmap and the additional main heatmap, the two heatmaps will share the same colorscale and colorbar.</p>
<p>See <a href="#orientation">Orientation</a> for adding main heataps vertically instead of horizontally!</p>
</div>
<div class="section level3">
<h3 id="add-labels">Add labels<a class="anchor" aria-label="anchor" href="#add-labels"></a>
</h3>
<p>Row and column labels are not shown by default. To add them, use the <code>add_row_labels</code> or <code>add_col_labels</code>. By default, these will use the row and column names provided to the <code>main_heatmap</code> or <code>add_main_heatmap</code> either directly or indirectly via the row and column names of the matrix.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_labels.html">add_row_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_labels.html">add_col_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_title.html">add_row_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_title.html">add_col_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-c6e6d2b732843e5c7216" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-c6e6d2b732843e5c7216">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis2":{"domain":[0.090534979423868345,0.17283950617283961],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis":{"domain":[0.17695473251028815,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis3":{"domain":[0,0.082304526748971193],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.17695473251028815,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.0905349794238684,0.17283950617283958],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0,0.082304526748971277],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Patient 1","y":1,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 2","y":2,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 3","y":3,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 4","y":4,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 5","y":5,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"Patient 6","y":6,"x":1,"textangle":0,"showarrow":false,"xref":"x2","yref":"y","font":[],"xanchor":"right"},{"text":"0.25","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"0.5","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"0.75","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"1","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"1.25","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"2","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"3","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"4","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"5","x":9,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"6","x":10,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"8","x":11,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x3","yref":"y"},{"text":"Patients","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-clustering">Add clustering<a class="anchor" aria-label="anchor" href="#add-clustering"></a>
</h3>
<p>The functions <code>add_row_clustering</code> and <code>add_col_clustering</code> will cluster the rows or columns. By default, the clustering is via hierarchical clustering and a dendrogram is added.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_clustering.html">add_col_clustering</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-277be88e70a394bef6c5" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-277be88e70a394bef6c5">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0.1341991341991341,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0,0.12987012987012989],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.8658008658008659],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.8701298701298702,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Specifying a value of k will result in cluster assignments being made based on the dendrogram and an annotation heatmap gets added showing the clustering.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_clustering.html">add_col_clustering</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-a356a33439c64914123c" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-a356a33439c64914123c">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 5<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}}],"layout":{"xaxis2":{"domain":[0.12809917355371891,0.16942148760330566],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.17355371900826433,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis3":{"domain":[0,0.12396694214876035],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.8658008658008659],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.8701298701298702,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Alternatively, clustering can be done using kmeans by setting <code>method = "kmeans"</code>. In that case, a value of k must be given!</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, method <span class="op">=</span> <span class="st">"kmeans"</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-d08eb72585182b58a5dd" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-d08eb72585182b58a5dd">{"x":{"data":[{"z":[[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"z":[[1],[1],[2],[2],[3],[3]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 3<br>Col: Groups<br>Value: 1"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 1<br>Col: Groups<br>Value: 3"],["Row: Patient 5<br>Col: Groups<br>Value: 3"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}}],"layout":{"xaxis":{"domain":[0.052132701421800931,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.047393364928909956],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Another way of clustering the results is by giving group assignments.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"groups"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-bfe846fcde1254963d51" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-bfe846fcde1254963d51">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"z":[[1],[1],[1],[1],[2],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0.052132701421800931,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.047393364928909956],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><div class="section level4">
<h4 id="using-your-own-clustering">Using your own clustering<a class="anchor" aria-label="anchor" href="#using-your-own-clustering"></a>
</h4>
<p>The functions <code>add_row_clustering</code> and <code>add_col_clustering</code> will perform clustering based on the options given. However, you might in some cases want more control over the clustering or be able to ensure the clustering matches that from some other analysis or visualization. To give you more control over the clustering, there are two lower-level functions that take in a clustering result and simply add them to the plot.</p>
<p>For hierarchical clustering, you can use the <code>add_row_dendro</code> or <code>add_col_dendro</code> functions to add the dendrogram. The clustering result should be provided as an “hclust” object.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clust_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Indometh_patient_cor</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_dendro.html">add_row_dendro</a></span><span class="op">(</span><span class="va">clust_res</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_dendro.html">add_col_dendro</a></span><span class="op">(</span><span class="va">clust_res</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-3c9f6435f14749c24e18" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-3c9f6435f14749c24e18">{"x":{"data":[{"z":[[1,0.98422083924353687,0.98546314943956226,0.9805738701315686,0.95101313087733663,0.94556934588853947],[0.98422083924353687,1,0.99207548971242576,0.99438314653884341,0.96457133375849846,0.98411231747827921],[0.98546314943956226,0.99207548971242576,1,0.99583844670750599,0.96592379671861694,0.97491250508018246],[0.9805738701315686,0.99438314653884341,0.99583844670750599,1,0.97655467171200183,0.98818406523791724],[0.95101313087733663,0.96457133375849846,0.96592379671861694,0.97655467171200183,1,0.96577390196500623],[0.94556934588853947,0.98411231747827921,0.97491250508018246,0.98818406523791724,0.96577390196500623,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946"],["Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984"],["Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975"],["Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988"],["Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}}],"layout":{"xaxis":{"domain":[0.1341991341991341,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0,0.12987012987012989],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.8658008658008659],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.8701298701298702,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.05443065411146053,"x1":-0.05443065411146053,"y0":3.6875,"y1":1.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.05443065411146053,"x1":-0.019426129868431397,"y0":1.875,"y1":1.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.05443065411146053,"x1":-0.05443065411146053,"y0":3.6875,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.05443065411146053,"x1":-0.034226098034993768,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.019426129868431397,"x1":-0.019426129868431397,"y0":1.875,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.019426129868431397,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.019426129868431397,"x1":-0.019426129868431397,"y0":1.875,"y1":2.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.019426129868431397,"x1":-0.0079245102875742379,"y0":2.75,"y1":2.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0079245102875742379,"x1":-0.0079245102875742379,"y0":2.75,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0079245102875742379,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0079245102875742379,"x1":-0.0079245102875742379,"y0":2.75,"y1":3.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0079245102875742379,"x1":-0.0041615532924940135,"y0":3.5,"y1":3.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0041615532924940135,"x1":-0.0041615532924940135,"y0":3.5,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0041615532924940135,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0041615532924940135,"x1":-0.0041615532924940135,"y0":3.5,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.0041615532924940135,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.034226098034993768,"x1":-0.034226098034993768,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.034226098034993768,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.034226098034993768,"x1":-0.034226098034993768,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.034226098034993768,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":3.6875,"x1":1.875,"y0":0.05443065411146053,"y1":0.05443065411146053,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":1.875,"y0":0.05443065411146053,"y1":0.019426129868431397,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.6875,"x1":5.5,"y0":0.05443065411146053,"y1":0.05443065411146053,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.05443065411146053,"y1":0.034226098034993768,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":1,"y0":0.019426129868431397,"y1":0.019426129868431397,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.019426129868431397,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.875,"x1":2.75,"y0":0.019426129868431397,"y1":0.019426129868431397,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":2.75,"y0":0.019426129868431397,"y1":0.0079245102875742379,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":2,"y0":0.0079245102875742379,"y1":0.0079245102875742379,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.0079245102875742379,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.75,"x1":3.5,"y0":0.0079245102875742379,"y1":0.0079245102875742379,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":3.5,"y0":0.0079245102875742379,"y1":0.0041615532924940135,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":3,"y0":0.0041615532924940135,"y1":0.0041615532924940135,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.0041615532924940135,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.5,"x1":4,"y0":0.0041615532924940135,"y1":0.0041615532924940135,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.0041615532924940135,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.034226098034993768,"y1":0.034226098034993768,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.034226098034993768,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.034226098034993768,"y1":0.034226098034993768,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.034226098034993768,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>If you want to add a dendrogram but have already ordered your matrix, you can set the “reorder” argument to <code>FALSE</code>.</p>
<p>For adding cluster assignments from a method like K-means, the <code>add_col_clusters</code> and <code>add_row_clusters</code> functions can be used. These functions will take in a vector of cluster assignments and both add an annotation heatmap showing the assignments and also re-order the rows or columns based on the clustering.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clust_assign</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clusters.html">add_row_clusters</a></span><span class="op">(</span><span class="va">clust_assign</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_clusters.html">add_col_clusters</a></span><span class="op">(</span><span class="va">clust_assign</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-f6f93f2e11f806dd814d" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-f6f93f2e11f806dd814d">{"x":{"data":[{"z":[[1,0.99583844670750599,0.96592379671861694,0.97491250508018246,0.99207548971242576,0.98546314943956226],[0.99583844670750599,1,0.97655467171200183,0.98818406523791724,0.99438314653884341,0.9805738701315686],[0.96592379671861694,0.97655467171200183,1,0.96577390196500623,0.96457133375849846,0.95101313087733663],[0.97491250508018246,0.98818406523791724,0.96577390196500623,1,0.98411231747827921,0.94556934588853947],[0.99207548971242576,0.99438314653884341,0.96457133375849846,0.98411231747827921,1,0.98422083924353687],[0.98546314943956226,0.9805738701315686,0.95101313087733663,0.94556934588853947,0.98422083924353687,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981"],["Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951"],["Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946"],["Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984"],["Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 5<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1],[1],[2],[2],[3],[3]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 3<br>Col: Groups<br>Value: 1"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 1<br>Col: Groups<br>Value: 3"],["Row: Patient 5<br>Col: Groups<br>Value: 3"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"z":[[1,1,2,2,3,3]],"x":[1,2,3,4,5,6],"y":1,"type":"heatmap","text":[["Row: Groups<br>Col: Patient 3<br>Value: 1","Row: Groups<br>Col: Patient 6<br>Value: 1","Row: Groups<br>Col: Patient 2<br>Value: 2","Row: Groups<br>Col: Patient 4<br>Value: 2","Row: Groups<br>Col: Patient 1<br>Value: 3","Row: Groups<br>Col: Patient 5<br>Value: 3"]],"colorscale":[[0,"#A6CEE3"],[0.33333333333333331,"#A6CEE3"],[0.33333333333333331,"#1F78B4"],[0.66666666666666663,"#1F78B4"],[0.66666666666666663,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x","yaxis":"y2","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Col<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}}],"layout":{"xaxis":{"domain":[0.052132701421800931,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0,0.047393364928909956],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,0.93896713615023475],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.95305164319248825,1],"anchor":"x","anchor.1":"x","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":""},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.3700000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>The <code>add_row_clusters</code> and <code>add_col_clusters</code> methods are very similar to <code>add_col_groups</code> and <code>add_col_groups</code>; the main difference is that <code>add_row_clusters</code> and <code>dd_col_clusters</code> will also reorder the rows and columns in addition to adding the annotation heatmap.</p>
</div>
</div>
<div class="section level3">
<h3 id="add-annotations">Add annotations<a class="anchor" aria-label="anchor" href="#add-annotations"></a>
</h3>
<p>The functions <code>add_row_annotation</code> and <code>add_col_annotation</code> add one or more annotation heatmaps. Annotations should be provided as a data.frame or something that can be coerced into a data.frame.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-50f8b15389e811a7f169" style="width:576px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-50f8b15389e811a7f169">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5],[2.0299999999999998],[2.7200000000000002],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"]],"colorscale":[[0,"#F7FCFD"],[0.28688524590163939,"#BDE6DD"],[0.43442622950819648,"#81CEB7"],[0.45081967213114732,"#7BCBB2"],[0.66393442622950816,"#38A367"],[1,"#00441B"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.050000000000000003],[0.080000000000000002],[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"]],"colorscale":[[0,"#FFFFCC"],[0.24999999999999992,"#FED976"],[0.50000000000000022,"#FD8D3C"],[0.75000000000000011,"#E31A1C"],[1,"#800026"]],"xaxis":"x3","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.84745762711864392],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.86016949152542355,0.90254237288135575],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.90889830508474556,0.95127118644067776],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.9576271186440678,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.3700000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>By default, colors will be chosen for each annotation. To assign colors yourself, provide a list of colors, with the names of the list matching the column names of the annotation. Colors can either be the name of an RColorBrewer palette or a vector of colors.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="st">"Reds"</span>,</span>
<span>                                   <span class="st">"Min"</span> <span class="op">=</span> <span class="st">"Blues"</span>,</span>
<span>                                   <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>,<span class="st">"pink"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-f235624177183b68e69c" style="width:576px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-f235624177183b68e69c">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5],[2.0299999999999998],[2.7200000000000002],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.28688524590163939,"#FDAF93"],[0.43442622950819648,"#FC805F"],[0.45081967213114732,"#FC7A5A"],[0.66393442622950816,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.050000000000000003],[0.080000000000000002],[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.24999999999999992,"#C6DBEF"],[0.50000000000000022,"#6BAED6"],[0.75000000000000011,"#2171B5"],[1,"#08306B"]],"xaxis":"x3","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.84745762711864392],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.86016949152542355,0.90254237288135575],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.90889830508474556,0.95127118644067776],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.9576271186440678,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.3700000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>For more control over annotation heatmaps, use the functions <code>add_col_signal</code> and <code>add_row_signal</code> for adding a single continuous annotation or <code>add_col_groups</code> and <code>add_row_groups</code> for adding a single discrete annotation.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_signal.html">add_row_signal</a></span><span class="op">(</span><span class="va">patient_max_conc</span>, <span class="st">"Max&lt;br&gt;Concentration"</span>, title <span class="op">=</span> <span class="st">"Max"</span>, colors <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_signal.html">add_row_signal</a></span><span class="op">(</span><span class="va">patient_min_conc</span>, <span class="st">"Min&lt;br&gt;Concentration"</span>, title <span class="op">=</span> <span class="st">"Min"</span>, colors <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_groups.html">add_row_groups</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span>, <span class="st">"Groups"</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-72eff897651702a84d93" style="width:576px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-72eff897651702a84d93">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5],[2.0299999999999998],[2.7200000000000002],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.28688524590163939,"#FDAF93"],[0.43442622950819648,"#FC805F"],[0.45081967213114732,"#FC7A5A"],[0.66393442622950816,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Max<br>Concentration","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.050000000000000003],[0.080000000000000002],[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"]],"colorscale":[[0,"#FFF5F0"],[0.24999999999999992,"#FCBBA1"],[0.50000000000000022,"#FB6A4A"],[0.75000000000000011,"#CB181D"],[1,"#67000D"]],"xaxis":"x3","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Min<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"#1B9E77"],[0.5,"#1B9E77"],[0.5,"#7570B3"],[1,"#7570B3"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.84388185654008441],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.85654008438818563,0.89873417721518989],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.91139240506329122,0.95358649789029537],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.95780590717299574,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.3700000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-summary">Add summary<a class="anchor" aria-label="anchor" href="#add-summary"></a>
</h3>
<p>One type of subplot that can be added is a summary of the values over the rows or the columns. For example when plotting Indometh concentrations per patient over time we might want to plot the average time response using <code>add_col_summary</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-b2633f8bcb1d97164168" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-b2633f8bcb1d97164168">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p><code>add_row_summary</code> is similar but adds plot along left summarizing rows.</p>
<p>With <code>add_col_summary</code> or <code>add_row_summary</code> we can pass groups to divide by the rows or columns respectively when computing the summary:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-51512b89953cebfe9169" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-51512b89953cebfe9169">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"#1B9E77"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.9724999999999999,1.2625,0.83250000000000002,0.60250000000000004,0.48749999999999999,0.29999999999999999,0.20250000000000001,0.14750000000000002,0.13500000000000001,0.097500000000000003,0.070000000000000007],"text":["A<br>Column: 0.25<br>Value: 1.9725","A<br>Column: 0.5<br>Value: 1.2625","A<br>Column: 0.75<br>Value: 0.8325","A<br>Column: 1<br>Value: 0.6025","A<br>Column: 1.25<br>Value: 0.4875","A<br>Column: 2<br>Value: 0.3","A<br>Column: 3<br>Value: 0.2025","A<br>Column: 4<br>Value: 0.1475","A<br>Column: 5<br>Value: 0.135","A<br>Column: 6<br>Value: 0.0975","A<br>Column: 8<br>Value: 0.07"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"A"},{"line":{"color":"#7570B3"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.2850000000000001,1.4399999999999999,1.0899999999999999,0.84499999999999997,0.69500000000000006,0.39500000000000002,0.19,0.11499999999999999,0.10500000000000001,0.075000000000000011,0.075000000000000011],"text":["B<br>Column: 0.25<br>Value: 2.285","B<br>Column: 0.5<br>Value: 1.44","B<br>Column: 0.75<br>Value: 1.09","B<br>Column: 1<br>Value: 0.845","B<br>Column: 1.25<br>Value: 0.695","B<br>Column: 2<br>Value: 0.395","B<br>Column: 3<br>Value: 0.19","B<br>Column: 4<br>Value: 0.115","B<br>Column: 5<br>Value: 0.105","B<br>Column: 6<br>Value: 0.075","B<br>Column: 8<br>Value: 0.075"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"B"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>If groups is set to <code>TRUE</code> rather than a vector of groups, then the function will try to use an existing set of groups or clusters that have been added to the plot. This should be avoided if more than one set of groups has been added (only one of the existing sets of groups will be used in that case.)</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>groups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-817fe7e0c858e9e9ff78" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-817fe7e0c858e9e9ff78">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"z":[[1],[1],[3],[3],[2],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 5<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 3"],["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"line":{"color":"#1B9E77"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.7749999999999999,0.98999999999999999,0.79500000000000004,0.435,0.33499999999999996,0.21000000000000002,0.125,0.11,0.080000000000000002,0.085000000000000006,0.055],"text":["1<br>Column: 0.25<br>Value: 1.775","1<br>Column: 0.5<br>Value: 0.99","1<br>Column: 0.75<br>Value: 0.795","1<br>Column: 1<br>Value: 0.435","1<br>Column: 1.25<br>Value: 0.335","1<br>Column: 2<br>Value: 0.21","1<br>Column: 3<br>Value: 0.125","1<br>Column: 4<br>Value: 0.11","1<br>Column: 5<br>Value: 0.08","1<br>Column: 6<br>Value: 0.085","1<br>Column: 8<br>Value: 0.055"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"1"},{"line":{"color":"#D95F02"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1.9399999999999999,1.5099999999999998,0.86499999999999999,0.79499999999999993,0.61499999999999999,0.38,0.23999999999999999,0.155,0.17499999999999999,0.095000000000000001,0.075000000000000011],"text":["2<br>Column: 0.25<br>Value: 1.94","2<br>Column: 0.5<br>Value: 1.51","2<br>Column: 0.75<br>Value: 0.865","2<br>Column: 1<br>Value: 0.795","2<br>Column: 1.25<br>Value: 0.615","2<br>Column: 2<br>Value: 0.38","2<br>Column: 3<br>Value: 0.24","2<br>Column: 4<br>Value: 0.155","2<br>Column: 5<br>Value: 0.175","2<br>Column: 6<br>Value: 0.095","2<br>Column: 8<br>Value: 0.075"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"2"},{"line":{"color":"#7570B3"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.5150000000000001,1.4649999999999999,1.095,0.82000000000000006,0.71999999999999997,0.40500000000000003,0.22999999999999998,0.14500000000000002,0.12,0.089999999999999997,0.084999999999999992],"text":["3<br>Column: 0.25<br>Value: 2.515","3<br>Column: 0.5<br>Value: 1.465","3<br>Column: 0.75<br>Value: 1.095","3<br>Column: 1<br>Value: 0.82","3<br>Column: 1.25<br>Value: 0.72","3<br>Column: 2<br>Value: 0.405","3<br>Column: 3<br>Value: 0.23","3<br>Column: 4<br>Value: 0.145","3<br>Column: 5<br>Value: 0.12","3<br>Column: 6<br>Value: 0.09","3<br>Column: 8<br>Value: 0.085"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter","name":"3"}],"layout":{"xaxis2":{"domain":[0.12809917355371891,0.16942148760330566],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.17355371900826433,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis3":{"domain":[0,0.12396694214876035],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-1.5081777083619823,"x1":-1.5081777083619823,"y0":3,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-0.57367238037053858,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-1.5081777083619823,"y0":3,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-0.91804139340228019,"y0":4.5,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0.57367238037053858,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0.57367238037053858,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.91804139340228019,"y0":4.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.46840153714521487,"y0":3.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.91804139340228019,"y0":4.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.53394756296849977,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0.46840153714521487,"y0":3.5,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0.46840153714521487,"y0":3.5,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0.53394756296849977,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0.53394756296849977,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>By default, summarization is done using <code>mean</code>. However, the <code>summary_function</code> argument can be set to ‘median’, ‘sd’, ‘var’, ‘mad’, ‘max’, ‘min’, or ‘sum’ in order to perform any of those alternate summarizations (Note: ‘sum’ only introduced in v0.4.4). We can also use the <code>layout</code> argument to pass a title to the new axis.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>summary_function <span class="op">=</span> <span class="st">"sd"</span>, </span>
<span>                  layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-d1fda15e1c64d67fec15" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-d1fda15e1c64d67fec15">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"z":[[1],[1],[3],[3],[2],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 5<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 3"],["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[0.41355370469464631,0.27095510083160762,0.17634246983261481,0.20422210131782179,0.18704723111200194,0.097039510853397584,0.076528861657982783,0.038815804341359041,0.064109281699298429,0.019999999999999997,0.014719601443879744],"text":["<br>Column: 0.25<br>Value: 0.413553704694646","<br>Column: 0.5<br>Value: 0.270955100831608","<br>Column: 0.75<br>Value: 0.176342469832615","<br>Column: 1<br>Value: 0.204222101317822","<br>Column: 1.25<br>Value: 0.187047231112002","<br>Column: 2<br>Value: 0.0970395108533976","<br>Column: 3<br>Value: 0.0765288616579828","<br>Column: 4<br>Value: 0.038815804341359","<br>Column: 5<br>Value: 0.0641092816992984","<br>Column: 6<br>Value: 0.02","<br>Column: 8<br>Value: 0.0147196014438797"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis2":{"domain":[0.12809917355371891,0.16942148760330566],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.17355371900826433,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis3":{"domain":[0,0.12396694214876035],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x","title":"sd"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-1.5081777083619823,"x1":-1.5081777083619823,"y0":3,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-0.57367238037053858,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-1.5081777083619823,"y0":3,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-1.5081777083619823,"x1":-0.91804139340228019,"y0":4.5,"y1":4.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0.57367238037053858,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0.57367238037053858,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.57367238037053858,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.91804139340228019,"y0":4.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.46840153714521487,"y0":3.5,"y1":3.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.91804139340228019,"y0":4.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.91804139340228019,"x1":-0.53394756296849977,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0.46840153714521487,"y0":3.5,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0.46840153714521487,"y0":3.5,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.46840153714521487,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0.53394756296849977,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0.53394756296849977,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.53394756296849977,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-barplot">Add barplot<a class="anchor" aria-label="anchor" href="#add-barplot"></a>
</h3>
<p>The functions <code>add_col_barplot</code> and <code>add_row_barplot</code> add barplots along the columns or rows of a main heatmap.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_barplot.html">add_col_barplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  tracename <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>                  layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-63fe537ae63fd4c51dba" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-63fe537ae63fd4c51dba">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"orientation":"v","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"text":["time<br>Column: 0.25<br>Value: 0.25","time<br>Column: 0.5<br>Value: 0.5","time<br>Column: 0.75<br>Value: 0.75","time<br>Column: 1<br>Value: 1","time<br>Column: 1.25<br>Value: 1.25","time<br>Column: 2<br>Value: 2","time<br>Column: 3<br>Value: 3","time<br>Column: 4<br>Value: 4","time<br>Column: 5<br>Value: 5","time<br>Column: 6<br>Value: 6","time<br>Column: 8<br>Value: 8"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":true,"type":"bar","name":"time"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.81967213114754101],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.83606557377049184,1],"anchor":"x","title":"Time"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-line-plot">Add line plot<a class="anchor" aria-label="anchor" href="#add-line-plot"></a>
</h3>
<p>The functions <code>add_col_barplot</code> and <code>add_row_barplot</code> add a line plot along the columns or rows of a main heatmap.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_plot.html">add_col_plot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  tracename <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>                  layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-c8196020ec90f5907bc8" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-c8196020ec90f5907bc8">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"text":["time<br>Column: 0.25<br>Value: 0.25","time<br>Column: 0.5<br>Value: 0.5","time<br>Column: 0.75<br>Value: 0.75","time<br>Column: 1<br>Value: 1","time<br>Column: 1.25<br>Value: 1.25","time<br>Column: 2<br>Value: 2","time<br>Column: 3<br>Value: 3","time<br>Column: 4<br>Value: 4","time<br>Column: 5<br>Value: 5","time<br>Column: 6<br>Value: 6","time<br>Column: 8<br>Value: 8"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":true,"type":"scatter","name":"time"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.81967213114754101],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.83606557377049184,1],"anchor":"x","title":"Time"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="add-arbitrary-plot">Add arbitrary plot<a class="anchor" aria-label="anchor" href="#add-arbitrary-plot"></a>
</h3>
<p>The functions for adding barplots or lineplots assume one data point per row or column. To add an arbitrary plot, one can use <code>add_subplot</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_subplot.html">add_subplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-3997f391edda99b0532a" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-3997f391edda99b0532a">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"x":[1,2,3],"y":[4,5,6],"xaxis":"x","yaxis":"y2"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.47619047619047616],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.52380952380952372,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="customization-options">Customization options<a class="anchor" aria-label="anchor" href="#customization-options"></a>
</h2>
<p>The next section of this vignette will cover some customization options available in <code>iheatmapr</code>.</p>
<div class="section level3">
<h3 id="color-selection">Color selection<a class="anchor" aria-label="anchor" href="#color-selection"></a>
</h3>
<p><code>iheatmapr</code> tries to choose colors automatically in a sensible way. If a heatmap with the same “name” argument as another heatmap is added, the two heatmaps will share the same colorbar and scale. Functions to make and add heatmaps and subplots have a “colors” argument that can be used to specify colors manually. These arguments take in RColorBrewer palette names or vectors of colors.</p>
<p>For example, if we simply repeat the same exact main heatmap with the same “name” argument and the same column names for the annotation matrices, the colorbars are not duplicated.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="st">"Reds"</span>,</span>
<span>                                   <span class="st">"Min"</span> <span class="op">=</span> <span class="st">"Blues"</span>,</span>
<span>                                   <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>,<span class="st">"pink"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="st">"Reds"</span>,</span>
<span>                                   <span class="st">"Min"</span> <span class="op">=</span> <span class="st">"Blues"</span>,</span>
<span>                                   <span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>,<span class="st">"pink"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-13b107b4eb168542774f" style="width:576px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-13b107b4eb168542774f">{"x":{"data":[{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5],[2.0299999999999998],[2.7200000000000002],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.28688524590163939,"#FDAF93"],[0.43442622950819648,"#FC805F"],[0.45081967213114732,"#FC7A5A"],[0.66393442622950816,"#E43127"],[1,"#67000D"]],"xaxis":"x2","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.050000000000000003],[0.080000000000000002],[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.24999999999999992,"#C6DBEF"],[0.50000000000000022,"#6BAED6"],[0.75000000000000011,"#2171B5"],[1,"#08306B"]],"xaxis":"x3","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x4","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[1,0.96457133375849846,0.99207548971242576,0.98411231747827921,0.98422083924353687,0.99438314653884341],[0.96457133375849846,1,0.96592379671861694,0.96577390196500623,0.95101313087733663,0.97655467171200183],[0.99207548971242576,0.96592379671861694,1,0.97491250508018246,0.98546314943956226,0.99583844670750599],[0.98411231747827921,0.96577390196500623,0.97491250508018246,1,0.94556934588853947,0.98818406523791724],[0.98422083924353687,0.95101313087733663,0.98546314943956226,0.94556934588853947,1,0.9805738701315686],[0.99438314653884341,0.97655467171200183,0.99583844670750599,0.98818406523791724,0.9805738701315686,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994"],["Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977"],["Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 3<br>Value: 1","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996"],["Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988"],["Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981"],["Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x5","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[1.5],[2.0299999999999998],[2.7200000000000002],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"]],"colorscale":[[0,"#FFF5F0"],[0.28688524590163939,"#FDAF93"],[0.43442622950819648,"#FC805F"],[0.45081967213114732,"#FC7A5A"],[0.66393442622950816,"#E43127"],[1,"#67000D"]],"xaxis":"x6","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.050000000000000003],[0.080000000000000002],[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"]],"colorscale":[[0,"#F7FBFF"],[0.24999999999999992,"#C6DBEF"],[0.50000000000000022,"#6BAED6"],[0.75000000000000011,"#2171B5"],[1,"#08306B"]],"xaxis":"x7","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.30000000000000004,"len":0.27000000000000002,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[2],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"],["Row: Patient 4<br>Col: Groups<br>Value: B"],["Row: Patient 5<br>Col: Groups<br>Value: A"],["Row: Patient 6<br>Col: Groups<br>Value: A"]],"colorscale":[[0,"purple"],[0.5,"purple"],[0.5,"pink"],[1,"pink"]],"xaxis":"x8","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.21,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}}],"layout":{"xaxis":{"domain":[0,0.41666666666666669],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.42291666666666661,0.44374999999999998],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis3":{"domain":[0.44687500000000002,0.46770833333333328],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis4":{"domain":[0.47083333333333344,0.49166666666666675],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.50833333333333341,0.92500000000000027],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis6":{"domain":[0.93125000000000024,0.9520833333333335],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.95520833333333344,0.9760416666666667],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis8":{"domain":[0.97916666666666663,1],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.3700000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="colorbars">Colorbars<a class="anchor" aria-label="anchor" href="#colorbars"></a>
</h3>
<p>When additional heatmaps or annotations with colorscales are added to an iheatmap object, the colorbars will be added according a grid pattern. The layout and spacing of that grid can be specified using the “colorbar_grid” parameter to iheatmap or simple_heatmap. By default, the grid has three rows. To change the layout of the grid to only have 2 rows and adjust the spacing and sizing of the colorbars, we can use the function setup_colorbar_grid to create a ColorbarGridParameters object that can be passed to the colorbar_grid argument to simple_heatmap.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/setup_colorbar_grid.html">setup_colorbar_grid</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                   y_length <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>                                   x_spacing <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                                   y_spacing <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                                   x_start <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>                                   y_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>         cluster_cols <span class="op">=</span> <span class="st">"hclust"</span>, </span>
<span>         cluster_rows <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>         col_title <span class="op">=</span> <span class="st">"Patients"</span>,</span>
<span>         name <span class="op">=</span> <span class="st">"Correlation"</span>,</span>
<span>         row_k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>         row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                     <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                     <span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span>,</span>
<span>         colorbar_grid <span class="op">=</span> <span class="va">grid_params</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_iheatmap.html">add_iheatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>               name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span></span>
<span>               col_title <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>         row_title <span class="op">=</span> <span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-5fbaf3e789ba3e1ff7f3" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-5fbaf3e789ba3e1ff7f3">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.1000000000000001,"y":1,"len":0.29999999999999999,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[2],[2],[3],[1],[1],[1]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: 2"],["Row: Patient 4<br>Col: Groups<br>Value: 2"],["Row: Patient 5<br>Col: Groups<br>Value: 3"],["Row: Patient 6<br>Col: Groups<br>Value: 1"],["Row: Patient 1<br>Col: Groups<br>Value: 1"],["Row: Patient 3<br>Col: Groups<br>Value: 1"]],"colorscale":[[0,"#1B9E77"],[0.33333333333333331,"#1B9E77"],[0.33333333333333331,"#D95F02"],[0.66666666666666663,"#D95F02"],[0.66666666666666663,"#7570B3"],[1,"#7570B3"]],"xaxis":"x2","yaxis":"y","zmin":1,"zmax":3,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.1000000000000001,"y":0.5,"len":0.29999999999999999,"title":"Row<br>Clusters","ypad":5,"thickness":20,"ticktext":["1","2","3"],"tickvals":[1.3333333333333333,2,2.6666666666666665]}},{"z":[[2.0299999999999998],[1.8500000000000001],[2.0499999999999998],[2.3100000000000001],[1.5],[2.7200000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Max<br>Value: 2.03"],["Row: Patient 4<br>Col: Max<br>Value: 1.85"],["Row: Patient 5<br>Col: Max<br>Value: 2.05"],["Row: Patient 6<br>Col: Max<br>Value: 2.31"],["Row: Patient 1<br>Col: Max<br>Value: 1.5"],["Row: Patient 3<br>Col: Max<br>Value: 2.72"]],"colorscale":[[0,"#F7FCFD"],[0.28688524590163939,"#BDE6DD"],[0.43442622950819648,"#81CEB7"],[0.45081967213114732,"#7BCBB2"],[0.66393442622950816,"#38A367"],[1,"#00441B"]],"xaxis":"x4","yaxis":"y","zmin":1.5,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.3,"y":1,"len":0.29999999999999999,"title":"Max","ypad":5,"thickness":20,"tickvals":[1.5,2.7000000000000002]}},{"z":[[0.080000000000000002],[0.070000000000000007],[0.059999999999999998],[0.089999999999999997],[0.050000000000000003],[0.080000000000000002]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Min<br>Value: 0.08"],["Row: Patient 4<br>Col: Min<br>Value: 0.07"],["Row: Patient 5<br>Col: Min<br>Value: 0.06"],["Row: Patient 6<br>Col: Min<br>Value: 0.09"],["Row: Patient 1<br>Col: Min<br>Value: 0.05"],["Row: Patient 3<br>Col: Min<br>Value: 0.08"]],"colorscale":[[0,"#FFFFCC"],[0.24999999999999992,"#FED976"],[0.50000000000000022,"#FD8D3C"],[0.75000000000000011,"#E31A1C"],[1,"#800026"]],"xaxis":"x5","yaxis":"y","zmin":0.050000000000000003,"zmax":0.089999999999999997,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.3,"y":0.5,"len":0.29999999999999999,"title":"Min","ypad":5,"thickness":20,"tickvals":[0.050000000000000003,0.089999999999999997]}},{"z":[[1],[1],[2],[1],[1],[2]],"y":[1,2,3,4,5,6],"x":1,"type":"heatmap","text":[["Row: Patient 2<br>Col: Groups<br>Value: A"],["Row: Patient 4<br>Col: Groups<br>Value: A"],["Row: Patient 5<br>Col: Groups<br>Value: B"],["Row: Patient 6<br>Col: Groups<br>Value: A"],["Row: Patient 1<br>Col: Groups<br>Value: A"],["Row: Patient 3<br>Col: Groups<br>Value: B"]],"colorscale":[[0,"#A6CEE3"],[0.5,"#A6CEE3"],[0.5,"#B2DF8A"],[1,"#B2DF8A"]],"xaxis":"x6","yaxis":"y","zmin":1,"zmax":2,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.5,"y":1,"len":0.29999999999999999,"title":"Groups","ypad":5,"thickness":20,"ticktext":["A","B"],"tickvals":[1.25,1.75]}},{"z":[[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997],[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"],["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"]],"colorscale":[[0,"#FFF7FB"],[0.0037453183520599225,"#FEF7FB"],[0.0074906367041198503,"#FEF6FA"],[0.011235955056179773,"#FDF6FA"],[0.014981273408239695,"#FDF5FA"],[0.018726591760299623,"#FCF5FA"],[0.022471910112359546,"#FCF4F9"],[0.02621722846441947,"#FBF4F9"],[0.029962546816479398,"#FAF3F9"],[0.041198501872659173,"#F9F2F8"],[0.0449438202247191,"#F8F1F8"],[0.052434456928838948,"#F7F0F7"],[0.056179775280898875,"#F6F0F7"],[0.063670411985018716,"#F5EFF6"],[0.067415730337078636,"#F5EEF6"],[0.07116104868913857,"#F4EEF6"],[0.074906367041198491,"#F4EDF6"],[0.09363295880149812,"#F1EBF4"],[0.10112359550561797,"#F0EAF4"],[0.11610486891385766,"#EDE8F3"],[0.11985018726591759,"#EDE8F2"],[0.12734082397003743,"#EBE7F2"],[0.13108614232209737,"#EBE6F1"],[0.13857677902621721,"#E9E5F1"],[0.16104868913857676,"#E4E1EF"],[0.20224719101123589,"#DBD9EB"],[0.22097378277153554,"#D6D6E9"],[0.24344569288389506,"#D1D2E7"],[0.24719101123595499,"#D1D1E6"],[0.27340823970037448,"#C8CDE4"],[0.28089887640449435,"#C6CCE3"],[0.28464419475655428,"#C5CBE3"],[0.29588014981273403,"#C1CAE2"],[0.31460674157303364,"#BBC7E0"],[0.33333333333333326,"#B4C4DF"],[0.36329588014981268,"#AABFDC"],[0.36704119850187261,"#A9BEDC"],[0.37078651685393255,"#A7BEDB"],[0.41573033707865159,"#96B6D7"],[0.50187265917602986,"#73A9CF"],[0.52059925093632953,"#6BA5CD"],[0.53932584269662909,"#63A1CA"],[0.54307116104868902,"#62A0CA"],[0.59176029962546806,"#4A97C4"],[0.67415730337078639,"#2983BA"],[0.74157303370786498,"#0C72B1"],[0.74906367041198485,"#0670B0"],[0.84644194756554303,"#045F95"],[1,"#023858"]],"xaxis":"x7","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.5,"y":0.5,"len":0.29999999999999999,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x7","yaxis":"y5","showlegend":false,"type":"scatter"}],"layout":{"xaxis3":{"domain":[0.040740740740740633,0.096296296296296213],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis2":{"domain":[0.098148148148148096,0.11666666666666659],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":[""],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis":{"domain":[0.11851851851851836,0.48888888888888882],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis4":{"domain":[0.49444444444444446,0.51296296296296295],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Max"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis5":{"domain":[0.51574074074074083,0.53425925925925943],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Min"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis6":{"domain":[0.53703703703703698,0.55555555555555558],"anchor":"y","anchor.1":"y","title":"","zeroline":false,"showline":false,"tickvals":[0],"ticktext":["Groups"],"showgrid":false,"fixedrange":true,"ticks":"","tickangle":-90},"xaxis7":{"domain":[0.62962962962962954,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis8":{"domain":[0,0.037037037037037049],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.076923076923076789,0.77622377622377625],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77972027972027969,0.88461538461538458],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis3":{"domain":[0,0.069930069930069783],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis4":{"domain":[0,0.069930069930069783],"anchor":"x7","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis5":{"domain":[0.79020979020979021,1],"anchor":"x7"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x3","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y3"},{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x7","yref":"y4"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x8","yref":"y"}],"legend":{"x":1.9000000000000001,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="continuous-axes">Continuous Axes<a class="anchor" aria-label="anchor" href="#continuous-axes"></a>
</h3>
<p>In all the plots above, the axes of the main heatmaps have been treated as categorical, with the columns of equal widths and rows of equal widths. In some cases, it may make sense to treat one or both axes as continuous. There are several ways to indicate to <code>iheatmapr</code> that the axes should be continuous. The first is to use the <code>x_categorical</code> and <code>y_categorical</code> arguments, setting them to false.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, x_categorical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-5680344d8dd32e50c6cb" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-5680344d8dd32e50c6cb">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>By default, names of rows and columns are taken from the row and column names of the matrix, respectively. Alternatively, these can be provided to the x and y arguments to <code>main_heatmap</code> or <code>iheatmap</code>. If the values are given as numeric and do not correspond simply to the row or column number, then the axis is assumed to be continuous.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-f8ee79053f6e4a3762c6" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-f8ee79053f6e4a3762c6">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><div class="section level4">
<h4 id="labels">Labels<a class="anchor" aria-label="anchor" href="#labels"></a>
</h4>
<p>Labels will be a bit different for continuous axes – rather than labelling every row or column, labels are chosen more similarly to a regular plot.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, x_categorical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_labels.html">add_col_labels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-fbb692155948177cb056" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-fbb692155948177cb056">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[0.25,0.5,0.75,1,1.25,2,3,4,5,6,8],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.125,9]},"yaxis":{"domain":[0.095022624434389136,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.090497737556561084],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"1","x":1,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"2","x":2,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"3","x":3,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"4","x":4,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"5","x":5,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"6","x":6,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"7","x":7,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"},{"text":"8","x":8,"y":1,"textangle":-90,"showarrow":false,"xref":"x","yref":"y2","font":[],"yanchor":"top"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h4>
<p>Another major difference with categorical axes is that continuous axes can’t be clustered!</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, x_categorical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_clustering.html">add_col_clustering</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># will give error</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in .local(p, ...): Cannot cluster continuous axis!</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="orientation">Orientation<a class="anchor" aria-label="anchor" href="#orientation"></a>
</h3>
<p>By default, additional heatmaps are added horizontally to left or right of existing heatmap(s). It is also possible to build up complex heatmaps vertically rather than horizontally by setting <code>orientation = vertical</code> to the initial call to <code>iheatmap</code> or <code>main_heatmap</code>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>, </span>
<span>         cluster_cols <span class="op">=</span> <span class="st">"hclust"</span>, </span>
<span>         cluster_rows <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>         row_title <span class="op">=</span> <span class="st">"Patients"</span>,</span>
<span>         name <span class="op">=</span> <span class="st">"Correlation"</span>,</span>
<span>         orientation <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_iheatmap.html">add_iheatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span>,</span>
<span>               name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span></span>
<span>               row_title <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>         col_title <span class="op">=</span> <span class="st">"Patients"</span><span class="op">)</span> </span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-d74cfa504fe902236787" style="width:384px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-d74cfa504fe902236787">{"x":{"data":[{"z":[[1,0.96577390196500623,0.95101313087733663,0.97655467171200183,0.96457133375849846,0.96592379671861694],[0.96577390196500623,1,0.94556934588853947,0.98818406523791724,0.98411231747827921,0.97491250508018246],[0.95101313087733663,0.94556934588853947,1,0.9805738701315686,0.98422083924353687,0.98546314943956226],[0.97655467171200183,0.98818406523791724,0.9805738701315686,1,0.99438314653884341,0.99583844670750599],[0.96457133375849846,0.98411231747827921,0.98422083924353687,0.99438314653884341,1,0.99207548971242576],[0.96592379671861694,0.97491250508018246,0.98546314943956226,0.99583844670750599,0.99207548971242576,1]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 2<br>Col: Patient 2<br>Value: 1","Row: Patient 2<br>Col: Patient 4<br>Value: 0.966","Row: Patient 2<br>Col: Patient 5<br>Value: 0.951","Row: Patient 2<br>Col: Patient 6<br>Value: 0.977","Row: Patient 2<br>Col: Patient 1<br>Value: 0.965","Row: Patient 2<br>Col: Patient 3<br>Value: 0.966"],["Row: Patient 4<br>Col: Patient 2<br>Value: 0.966","Row: Patient 4<br>Col: Patient 4<br>Value: 1","Row: Patient 4<br>Col: Patient 5<br>Value: 0.946","Row: Patient 4<br>Col: Patient 6<br>Value: 0.988","Row: Patient 4<br>Col: Patient 1<br>Value: 0.984","Row: Patient 4<br>Col: Patient 3<br>Value: 0.975"],["Row: Patient 5<br>Col: Patient 2<br>Value: 0.951","Row: Patient 5<br>Col: Patient 4<br>Value: 0.946","Row: Patient 5<br>Col: Patient 5<br>Value: 1","Row: Patient 5<br>Col: Patient 6<br>Value: 0.981","Row: Patient 5<br>Col: Patient 1<br>Value: 0.984","Row: Patient 5<br>Col: Patient 3<br>Value: 0.985"],["Row: Patient 6<br>Col: Patient 2<br>Value: 0.977","Row: Patient 6<br>Col: Patient 4<br>Value: 0.988","Row: Patient 6<br>Col: Patient 5<br>Value: 0.981","Row: Patient 6<br>Col: Patient 6<br>Value: 1","Row: Patient 6<br>Col: Patient 1<br>Value: 0.994","Row: Patient 6<br>Col: Patient 3<br>Value: 0.996"],["Row: Patient 1<br>Col: Patient 2<br>Value: 0.965","Row: Patient 1<br>Col: Patient 4<br>Value: 0.984","Row: Patient 1<br>Col: Patient 5<br>Value: 0.984","Row: Patient 1<br>Col: Patient 6<br>Value: 0.994","Row: Patient 1<br>Col: Patient 1<br>Value: 1","Row: Patient 1<br>Col: Patient 3<br>Value: 0.992"],["Row: Patient 3<br>Col: Patient 2<br>Value: 0.966","Row: Patient 3<br>Col: Patient 4<br>Value: 0.975","Row: Patient 3<br>Col: Patient 5<br>Value: 0.985","Row: Patient 3<br>Col: Patient 6<br>Value: 0.996","Row: Patient 3<br>Col: Patient 1<br>Value: 0.992","Row: Patient 3<br>Col: Patient 3<br>Value: 1"]],"colorscale":[[0,"#FFF7F3"],[0.10001322008090581,"#FEE5E1"],[0.34910452905907791,"#FBA7B7"],[0.37119811264977309,"#FAA0B5"],[0.37395197912552347,"#FA9FB5"],[0.53909253288699133,"#EF599E"],[0.56926241893055463,"#E94D9C"],[0.64310313396837959,"#D62F93"],[0.70811149009551233,"#BE1886"],[0.71010525201201313,"#BD1786"],[0.73292897545067415,"#B40C81"],[0.7829176416310073,"#A0017C"],[0.85441089369701861,"#830178"],[0.89680716587284326,"#720075"],[0.92354394117748095,"#670072"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.94556934588853947,"zmax":1,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Correlation","ypad":5,"thickness":20,"tickvals":[0.94600000000000006,1]}},{"z":[[2.0299999999999998,1.8500000000000001,2.0499999999999998,2.3100000000000001,1.5,2.7200000000000002],[1.6299999999999999,1.3899999999999999,1.04,1.4399999999999999,0.93999999999999995,1.49],[0.70999999999999996,1.02,0.81000000000000005,1.03,0.78000000000000003,1.1599999999999999],[0.69999999999999996,0.89000000000000001,0.39000000000000001,0.83999999999999997,0.47999999999999998,0.80000000000000004],[0.64000000000000001,0.58999999999999997,0.29999999999999999,0.64000000000000001,0.37,0.80000000000000004],[0.35999999999999999,0.40000000000000002,0.23000000000000001,0.41999999999999998,0.19,0.39000000000000001],[0.32000000000000001,0.16,0.13,0.23999999999999999,0.12,0.22],[0.20000000000000001,0.11,0.11,0.17000000000000001,0.11,0.12],[0.25,0.10000000000000001,0.080000000000000002,0.13,0.080000000000000002,0.11],[0.12,0.070000000000000007,0.10000000000000001,0.10000000000000001,0.070000000000000007,0.080000000000000002],[0.080000000000000002,0.070000000000000007,0.059999999999999998,0.089999999999999997,0.050000000000000003,0.080000000000000002]],"x":[1,2,3,4,5,6],"y":[1,2,3,4,5,6,7,8,9,10,11],"type":"heatmap","text":[["Row: 0.25<br>Col: Patient 2<br>Value: 2.03","Row: 0.25<br>Col: Patient 4<br>Value: 1.85","Row: 0.25<br>Col: Patient 5<br>Value: 2.05","Row: 0.25<br>Col: Patient 6<br>Value: 2.31","Row: 0.25<br>Col: Patient 1<br>Value: 1.5","Row: 0.25<br>Col: Patient 3<br>Value: 2.72"],["Row: 0.5<br>Col: Patient 2<br>Value: 1.63","Row: 0.5<br>Col: Patient 4<br>Value: 1.39","Row: 0.5<br>Col: Patient 5<br>Value: 1.04","Row: 0.5<br>Col: Patient 6<br>Value: 1.44","Row: 0.5<br>Col: Patient 1<br>Value: 0.94","Row: 0.5<br>Col: Patient 3<br>Value: 1.49"],["Row: 0.75<br>Col: Patient 2<br>Value: 0.71","Row: 0.75<br>Col: Patient 4<br>Value: 1.02","Row: 0.75<br>Col: Patient 5<br>Value: 0.81","Row: 0.75<br>Col: Patient 6<br>Value: 1.03","Row: 0.75<br>Col: Patient 1<br>Value: 0.78","Row: 0.75<br>Col: Patient 3<br>Value: 1.16"],["Row: 1<br>Col: Patient 2<br>Value: 0.7","Row: 1<br>Col: Patient 4<br>Value: 0.89","Row: 1<br>Col: Patient 5<br>Value: 0.39","Row: 1<br>Col: Patient 6<br>Value: 0.84","Row: 1<br>Col: Patient 1<br>Value: 0.48","Row: 1<br>Col: Patient 3<br>Value: 0.8"],["Row: 1.25<br>Col: Patient 2<br>Value: 0.64","Row: 1.25<br>Col: Patient 4<br>Value: 0.59","Row: 1.25<br>Col: Patient 5<br>Value: 0.3","Row: 1.25<br>Col: Patient 6<br>Value: 0.64","Row: 1.25<br>Col: Patient 1<br>Value: 0.37","Row: 1.25<br>Col: Patient 3<br>Value: 0.8"],["Row: 2<br>Col: Patient 2<br>Value: 0.36","Row: 2<br>Col: Patient 4<br>Value: 0.4","Row: 2<br>Col: Patient 5<br>Value: 0.23","Row: 2<br>Col: Patient 6<br>Value: 0.42","Row: 2<br>Col: Patient 1<br>Value: 0.19","Row: 2<br>Col: Patient 3<br>Value: 0.39"],["Row: 3<br>Col: Patient 2<br>Value: 0.32","Row: 3<br>Col: Patient 4<br>Value: 0.16","Row: 3<br>Col: Patient 5<br>Value: 0.13","Row: 3<br>Col: Patient 6<br>Value: 0.24","Row: 3<br>Col: Patient 1<br>Value: 0.12","Row: 3<br>Col: Patient 3<br>Value: 0.22"],["Row: 4<br>Col: Patient 2<br>Value: 0.2","Row: 4<br>Col: Patient 4<br>Value: 0.11","Row: 4<br>Col: Patient 5<br>Value: 0.11","Row: 4<br>Col: Patient 6<br>Value: 0.17","Row: 4<br>Col: Patient 1<br>Value: 0.11","Row: 4<br>Col: Patient 3<br>Value: 0.12"],["Row: 5<br>Col: Patient 2<br>Value: 0.25","Row: 5<br>Col: Patient 4<br>Value: 0.1","Row: 5<br>Col: Patient 5<br>Value: 0.08","Row: 5<br>Col: Patient 6<br>Value: 0.13","Row: 5<br>Col: Patient 1<br>Value: 0.08","Row: 5<br>Col: Patient 3<br>Value: 0.11"],["Row: 6<br>Col: Patient 2<br>Value: 0.12","Row: 6<br>Col: Patient 4<br>Value: 0.07","Row: 6<br>Col: Patient 5<br>Value: 0.1","Row: 6<br>Col: Patient 6<br>Value: 0.1","Row: 6<br>Col: Patient 1<br>Value: 0.07","Row: 6<br>Col: Patient 3<br>Value: 0.08"],["Row: 8<br>Col: Patient 2<br>Value: 0.08","Row: 8<br>Col: Patient 4<br>Value: 0.07","Row: 8<br>Col: Patient 5<br>Value: 0.06","Row: 8<br>Col: Patient 6<br>Value: 0.09","Row: 8<br>Col: Patient 1<br>Value: 0.05","Row: 8<br>Col: Patient 3<br>Value: 0.08"]],"colorscale":[[0,"#F7FCFD"],[0.0037453183520599225,"#F6FCFD"],[0.0074906367041198503,"#F6FCFD"],[0.011235955056179773,"#F5FBFD"],[0.014981273408239695,"#F5FBFD"],[0.018726591760299623,"#F4FBFC"],[0.022471910112359546,"#F4FBFC"],[0.02621722846441947,"#F3FBFC"],[0.029962546816479398,"#F3FAFC"],[0.041198501872659173,"#F1FAFC"],[0.0449438202247191,"#F1F9FC"],[0.052434456928838948,"#EFF9FB"],[0.056179775280898875,"#EFF9FB"],[0.063670411985018716,"#EEF8FB"],[0.067415730337078636,"#EDF8FB"],[0.07116104868913857,"#EDF8FB"],[0.074906367041198491,"#ECF8FB"],[0.09363295880149812,"#EAF7FA"],[0.10112359550561797,"#E8F6FA"],[0.11610486891385766,"#E6F5F9"],[0.11985018726591759,"#E6F5F9"],[0.12734082397003743,"#E5F5F9"],[0.13108614232209737,"#E4F5F8"],[0.13857677902621721,"#E2F4F7"],[0.16104868913857676,"#DEF2F3"],[0.20224719101123589,"#D6EFED"],[0.22097378277153554,"#D2EEEA"],[0.24344569288389506,"#CDECE7"],[0.24719101123595499,"#CDECE6"],[0.27340823970037448,"#C3E8E1"],[0.28089887640449435,"#C0E7DF"],[0.28464419475655428,"#BEE6DE"],[0.29588014981273403,"#BAE5DB"],[0.31460674157303364,"#B2E2D7"],[0.33333333333333326,"#AADFD3"],[0.36329588014981268,"#9EDACC"],[0.36704119850187261,"#9CD9CB"],[0.37078651685393255,"#9BD9CA"],[0.41573033707865159,"#89D1BD"],[0.50187265917602986,"#65C2A3"],[0.52059925093632953,"#60BF9C"],[0.53932584269662909,"#5BBC95"],[0.54307116104868902,"#5ABB94"],[0.59176029962546806,"#4CB382"],[0.67415730337078639,"#36A063"],[0.74157303370786498,"#258D48"],[0.74906367041198485,"#238B45"],[0.84644194756554303,"#0A7432"],[1,"#00441B"]],"xaxis":"x","yaxis":"y3","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.60000000000000009,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0.20948616600790493,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"xaxis2":{"domain":[0.086956521739130294,0.20553359683794445],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"xaxis3":{"domain":[0,0.079051383399209335],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"xaxis4":{"domain":[0.12252964426877445,0.20158102766798397],"anchor":"y3","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.044624746450304231,0.45030425963488852],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0.53144016227180524,0.93711967545638952],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.9391480730223124,1],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","fixedrange":true},"yaxis4":{"domain":[0,0.040567951318458424],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"shapes":[{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.054501156730228019,"y0":1.5,"y1":1.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.079451340580469959,"y0":2.6875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.079451340580469959,"x1":-0.058600792995725473,"y0":3.875,"y1":3.875,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":1,"y1":1,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0.054501156730228019,"y0":1.5,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.054501156730228019,"x1":-0,"y0":2,"y1":2,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0,"y0":3,"y1":3,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.058600792995725473,"y0":3.875,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.058600792995725473,"x1":-0.018788751846197018,"y0":4.75,"y1":4.75,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0,"y0":4,"y1":4,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.018788751846197018,"y0":4.75,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.018788751846197018,"x1":-0.014687500264458381,"y0":5.5,"y1":5.5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":5,"y1":5,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0.014687500264458381,"y0":5.5,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":-0.014687500264458381,"x1":-0,"y0":6,"y1":6,"type":"line","xref":"x2","yref":"y","line":{"color":"gray"}},{"x0":2.6875,"x1":1.5,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1.5,"y0":0.079451340580469959,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2.6875,"x1":3.875,"y0":0.079451340580469959,"y1":0.079451340580469959,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3.875,"y0":0.079451340580469959,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":1,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1,"x1":1,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":1.5,"x1":2,"y0":0.054501156730228019,"y1":0.054501156730228019,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":2,"x1":2,"y0":0.054501156730228019,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":3,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3,"x1":3,"y0":0.058600792995725473,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":3.875,"x1":4.75,"y0":0.058600792995725473,"y1":0.058600792995725473,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4.75,"y0":0.058600792995725473,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":4,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4,"x1":4,"y0":0.018788751846197018,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":4.75,"x1":5.5,"y0":0.018788751846197018,"y1":0.018788751846197018,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5.5,"y0":0.018788751846197018,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":5,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5,"x1":5,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":5.5,"x1":6,"y0":0.014687500264458381,"y1":0.014687500264458381,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}},{"x0":6,"x1":6,"y0":0.014687500264458381,"y1":0,"type":"line","xref":"x","yref":"y2","line":{"color":"gray"}}],"annotations":[{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x3","yref":"y"},{"text":"Patients","x":3.5,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y4"},{"text":"Time","y":6,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x4","yref":"y3"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="margins-and-other-layout-properties">Margins and other layout properties<a class="anchor" aria-label="anchor" href="#margins-and-other-layout-properties"></a>
</h3>
<p>General plotly layout arguments can be passed to the <code>layout</code> argument to <code>main_heatmap</code> or <code>iheatmap</code>. See the <a href="https://plotly.com/javascript/reference/#layout" class="external-link">plotly documentation</a> for more information about the various options.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">120</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-4a1036def105c183614a" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-4a1036def105c183614a">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":120,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>The layout can also be adjusted after creation of the plot using the <code>modify_layout</code> function.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/modify_layout.html">modify_layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">120</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-0b5ce1303db1987de7ae" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-0b5ce1303db1987de7ae">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,1],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"hovermode":"closest","margin":{"b":120,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="axis-properties">Axis properties<a class="anchor" aria-label="anchor" href="#axis-properties"></a>
</h3>
<p>Most functions for adding a subplot include a “layout” argument for providing layout parameters for the additional axis that is created. This layout parameter accepts a list of layout parameters that plotly uses for altering the layout of an axis. See the <a href="https://plotly.com/javascript/reference/#layout-xaxis" class="external-link">plotly documentation</a> for more information about the various options.</p>
<p>As an example, here is a plot with default axis options:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>               name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span></span>
<span>               col_title <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>         row_title <span class="op">=</span> <span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-27c3bf86bf35ee82cf94" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-27c3bf86bf35ee82cf94">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0.099099099099099197,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.090090090090090086],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.076923076923076997,0.77622377622377625],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.069930069930070005],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.79020979020979021,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y2"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x2","yref":"y"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>Adding <code>zeroline = FALSE</code> removes the zero line, and <code>title = "Average"</code> adds yaxis label.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/iheatmap.html">iheatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>               name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span>, <span class="co"># html &lt;br&gt; tag used to split lines</span></span>
<span>               col_title <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>         row_title <span class="op">=</span> <span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>zeroline <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Average"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-c7172db86a7e7756351f" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-c7172db86a7e7756351f">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Indometacin<br>Concentration","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0.099099099099099197,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0,0.090090090090090086],"anchor":"y","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis":{"domain":[0.076923076923076997,0.77622377622377625],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0,0.069930069930070005],"anchor":"x","title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false,"ticks":"","range":[-1,1],"fixedrange":true},"yaxis3":{"domain":[0.79020979020979021,1],"anchor":"x","zeroline":false,"title":"Average"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"annotations":[{"text":"Time","x":6,"y":1,"textangle":0,"showarrow":false,"yanchor":"top","xanchor":"center","font":[],"xref":"x","yref":"y2"},{"text":"Patients","y":3.5,"x":1,"textangle":-90,"showarrow":false,"xanchor":"right","yanchor":"center","font":[],"xref":"x2","yref":"y"}],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="sharing-axes">Sharing axes<a class="anchor" aria-label="anchor" href="#sharing-axes"></a>
</h3>
<p>By default subplots stacked vertically share the X axis with a main heatmap, and subplots stacked horizontally share their Y axis with a main heatmap. Subplots can also be made to share the other axis with an existing subplot.</p>
<p>Here is an example of two subplots with independent axes:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-845f4bbcebefee5ec5eb" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-845f4bbcebefee5ec5eb">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"},{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x2","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x2","yaxis":"y3","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,0.49019607843137253],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0.50980392156862742,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"yaxis3":{"domain":[0.77272727272727271,1],"anchor":"x2"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><p>By passing the same “yname” argument to both axes, the axes become shared:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>yname <span class="op">=</span> <span class="st">"Summary"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>yname <span class="op">=</span> <span class="st">"Summary"</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-fe11daff80ffcd4063eb" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-fe11daff80ffcd4063eb">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"},{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x2","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x2","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,0.49019607843137253],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"xaxis2":{"domain":[0.50980392156862742,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="altering-plot-sizes-and-spacing">Altering plot sizes and spacing<a class="anchor" aria-label="anchor" href="#altering-plot-sizes-and-spacing"></a>
</h3>
<p>Each type of subplot has a default relative size and default relative spacing from the previous plots, but both the size and spacing can be altered by passing a ‘buffer’ or ‘size’ argument. Both arguments are relative to the size of the first main heatmap along that dimension.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-c1537153f1f3aae72881" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-c1537153f1f3aae72881">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.75757575757575757],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.77272727272727271,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span>buffer <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="iheatmapr html-widget html-fill-item" id="htmlwidget-cf4c8900cc531ca66cdc" style="width:432px;height:336px;"></div>
<script type="application/json" data-for="htmlwidget-cf4c8900cc531ca66cdc">{"x":{"data":[{"z":[[1.5,0.93999999999999995,0.78000000000000003,0.47999999999999998,0.37,0.19,0.12,0.11,0.080000000000000002,0.070000000000000007,0.050000000000000003],[2.0299999999999998,1.6299999999999999,0.70999999999999996,0.69999999999999996,0.64000000000000001,0.35999999999999999,0.32000000000000001,0.20000000000000001,0.25,0.12,0.080000000000000002],[2.7200000000000002,1.49,1.1599999999999999,0.80000000000000004,0.80000000000000004,0.39000000000000001,0.22,0.12,0.11,0.080000000000000002,0.080000000000000002],[1.8500000000000001,1.3899999999999999,1.02,0.89000000000000001,0.58999999999999997,0.40000000000000002,0.16,0.11,0.10000000000000001,0.070000000000000007,0.070000000000000007],[2.0499999999999998,1.04,0.81000000000000005,0.39000000000000001,0.29999999999999999,0.23000000000000001,0.13,0.11,0.080000000000000002,0.10000000000000001,0.059999999999999998],[2.3100000000000001,1.4399999999999999,1.03,0.83999999999999997,0.64000000000000001,0.41999999999999998,0.23999999999999999,0.17000000000000001,0.13,0.10000000000000001,0.089999999999999997]],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[1,2,3,4,5,6],"type":"heatmap","text":[["Row: Patient 1<br>Col: 0.25<br>Value: 1.5","Row: Patient 1<br>Col: 0.5<br>Value: 0.94","Row: Patient 1<br>Col: 0.75<br>Value: 0.78","Row: Patient 1<br>Col: 1<br>Value: 0.48","Row: Patient 1<br>Col: 1.25<br>Value: 0.37","Row: Patient 1<br>Col: 2<br>Value: 0.19","Row: Patient 1<br>Col: 3<br>Value: 0.12","Row: Patient 1<br>Col: 4<br>Value: 0.11","Row: Patient 1<br>Col: 5<br>Value: 0.08","Row: Patient 1<br>Col: 6<br>Value: 0.07","Row: Patient 1<br>Col: 8<br>Value: 0.05"],["Row: Patient 2<br>Col: 0.25<br>Value: 2.03","Row: Patient 2<br>Col: 0.5<br>Value: 1.63","Row: Patient 2<br>Col: 0.75<br>Value: 0.71","Row: Patient 2<br>Col: 1<br>Value: 0.7","Row: Patient 2<br>Col: 1.25<br>Value: 0.64","Row: Patient 2<br>Col: 2<br>Value: 0.36","Row: Patient 2<br>Col: 3<br>Value: 0.32","Row: Patient 2<br>Col: 4<br>Value: 0.2","Row: Patient 2<br>Col: 5<br>Value: 0.25","Row: Patient 2<br>Col: 6<br>Value: 0.12","Row: Patient 2<br>Col: 8<br>Value: 0.08"],["Row: Patient 3<br>Col: 0.25<br>Value: 2.72","Row: Patient 3<br>Col: 0.5<br>Value: 1.49","Row: Patient 3<br>Col: 0.75<br>Value: 1.16","Row: Patient 3<br>Col: 1<br>Value: 0.8","Row: Patient 3<br>Col: 1.25<br>Value: 0.8","Row: Patient 3<br>Col: 2<br>Value: 0.39","Row: Patient 3<br>Col: 3<br>Value: 0.22","Row: Patient 3<br>Col: 4<br>Value: 0.12","Row: Patient 3<br>Col: 5<br>Value: 0.11","Row: Patient 3<br>Col: 6<br>Value: 0.08","Row: Patient 3<br>Col: 8<br>Value: 0.08"],["Row: Patient 4<br>Col: 0.25<br>Value: 1.85","Row: Patient 4<br>Col: 0.5<br>Value: 1.39","Row: Patient 4<br>Col: 0.75<br>Value: 1.02","Row: Patient 4<br>Col: 1<br>Value: 0.89","Row: Patient 4<br>Col: 1.25<br>Value: 0.59","Row: Patient 4<br>Col: 2<br>Value: 0.4","Row: Patient 4<br>Col: 3<br>Value: 0.16","Row: Patient 4<br>Col: 4<br>Value: 0.11","Row: Patient 4<br>Col: 5<br>Value: 0.1","Row: Patient 4<br>Col: 6<br>Value: 0.07","Row: Patient 4<br>Col: 8<br>Value: 0.07"],["Row: Patient 5<br>Col: 0.25<br>Value: 2.05","Row: Patient 5<br>Col: 0.5<br>Value: 1.04","Row: Patient 5<br>Col: 0.75<br>Value: 0.81","Row: Patient 5<br>Col: 1<br>Value: 0.39","Row: Patient 5<br>Col: 1.25<br>Value: 0.3","Row: Patient 5<br>Col: 2<br>Value: 0.23","Row: Patient 5<br>Col: 3<br>Value: 0.13","Row: Patient 5<br>Col: 4<br>Value: 0.11","Row: Patient 5<br>Col: 5<br>Value: 0.08","Row: Patient 5<br>Col: 6<br>Value: 0.1","Row: Patient 5<br>Col: 8<br>Value: 0.06"],["Row: Patient 6<br>Col: 0.25<br>Value: 2.31","Row: Patient 6<br>Col: 0.5<br>Value: 1.44","Row: Patient 6<br>Col: 0.75<br>Value: 1.03","Row: Patient 6<br>Col: 1<br>Value: 0.84","Row: Patient 6<br>Col: 1.25<br>Value: 0.64","Row: Patient 6<br>Col: 2<br>Value: 0.42","Row: Patient 6<br>Col: 3<br>Value: 0.24","Row: Patient 6<br>Col: 4<br>Value: 0.17","Row: Patient 6<br>Col: 5<br>Value: 0.13","Row: Patient 6<br>Col: 6<br>Value: 0.1","Row: Patient 6<br>Col: 8<br>Value: 0.09"]],"colorscale":[[0,"#FFF7F3"],[0.0037453183520599225,"#FFF6F2"],[0.0074906367041198503,"#FFF6F2"],[0.011235955056179773,"#FFF5F1"],[0.014981273408239695,"#FFF4F0"],[0.018726591760299623,"#FFF4F0"],[0.022471910112359546,"#FFF3EF"],[0.02621722846441947,"#FFF2EE"],[0.029962546816479398,"#FFF1EE"],[0.041198501872659173,"#FEEFEC"],[0.0449438202247191,"#FEEFEB"],[0.052434456928838948,"#FEEDEA"],[0.056179775280898875,"#FEEDE9"],[0.063670411985018716,"#FEEBE8"],[0.067415730337078636,"#FEEBE7"],[0.07116104868913857,"#FEEAE6"],[0.074906367041198491,"#FEE9E6"],[0.09363295880149812,"#FEE6E2"],[0.10112359550561797,"#FDE4E1"],[0.11610486891385766,"#FDE2DF"],[0.11985018726591759,"#FDE1DE"],[0.12734082397003743,"#FDDFDC"],[0.13108614232209737,"#FDDFDC"],[0.13857677902621721,"#FDDDDA"],[0.16104868913857676,"#FDD8D5"],[0.20224719101123589,"#FDCFCB"],[0.22097378277153554,"#FCCBC7"],[0.24344569288389506,"#FCC6C2"],[0.24719101123595499,"#FCC6C1"],[0.27340823970037448,"#FCBEBE"],[0.28089887640449435,"#FCBCBD"],[0.28464419475655428,"#FCBBBD"],[0.29588014981273403,"#FCB7BC"],[0.31460674157303364,"#FBB2BA"],[0.33333333333333326,"#FBACB9"],[0.36329588014981268,"#FAA3B6"],[0.36704119850187261,"#FAA1B6"],[0.37078651685393255,"#FAA0B5"],[0.41573033707865159,"#F98EAE"],[0.50187265917602986,"#F767A1"],[0.52059925093632953,"#F3609F"],[0.53932584269662909,"#EF599E"],[0.54307116104868902,"#EE589E"],[0.59176029962546806,"#E4449A"],[0.67415730337078639,"#CA258D"],[0.74157303370786498,"#B10680"],[0.74906367041198485,"#AE027E"],[0.84644194756554303,"#860179"],[1,"#49006A"]],"xaxis":"x","yaxis":"y","zmin":0.050000000000000003,"zmax":2.7200000000000002,"hoverinfo":"text","showscale":true,"colorbar":{"x":1.05,"y":0.90000000000000002,"len":0.27000000000000002,"title":"Signal","ypad":5,"thickness":20,"tickvals":[0.10000000000000001,2.7000000000000002]}},{"line":{"color":"black"},"mode":"lines+markers","x":[1,2,3,4,5,6,7,8,9,10,11],"y":[2.0766666666666667,1.3216666666666665,0.91833333333333333,0.68333333333333335,0.55666666666666664,0.33166666666666667,0.19833333333333333,0.13666666666666666,0.125,0.089999999999999997,0.07166666666666667],"text":["<br>Column: 0.25<br>Value: 2.07666666666667","<br>Column: 0.5<br>Value: 1.32166666666667","<br>Column: 0.75<br>Value: 0.918333333333333","<br>Column: 1<br>Value: 0.683333333333333","<br>Column: 1.25<br>Value: 0.556666666666667","<br>Column: 2<br>Value: 0.331666666666667","<br>Column: 3<br>Value: 0.198333333333333","<br>Column: 4<br>Value: 0.136666666666667","<br>Column: 5<br>Value: 0.125","<br>Column: 6<br>Value: 0.09","<br>Column: 8<br>Value: 0.0716666666666667"],"hoverinfo":"text","xaxis":"x","yaxis":"y2","showlegend":false,"type":"scatter"}],"layout":{"xaxis":{"domain":[0,1],"anchor":"y","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,11.5]},"yaxis":{"domain":[0,0.45454545454545453],"anchor":"x","ticks":"","zeroline":false,"showline":false,"showgrid":false,"showticklabels":false,"range":[0.5,6.5]},"yaxis2":{"domain":[0.54545454545454541,1],"anchor":"x"},"hovermode":"closest","margin":{"b":50,"t":50,"l":50,"r":50},"font":[],"legend":{"x":1.21,"xanchor":"left"}},"source":"iheatmapr","config":{"modeBarButtonsToRemove":["sendDataToCloud","autoScale2d"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="sizing-in-knitr">Sizing in knitr<a class="anchor" aria-label="anchor" href="#sizing-in-knitr"></a>
</h3>
<p>To change the sizing within knitr, use the fig.width and fig.height chunk options.</p>
</div>
</div>
<div class="section level2">
<h2 id="shiny">Shiny<a class="anchor" aria-label="anchor" href="#shiny"></a>
</h2>
<p>Iheatmap objects can be used in shiny. The <code>renderIheatmap</code> function should be used in the server code, and the <code>iheatmaprOutput</code> in the ui code.</p>
<p>For observing events, the <code>iheatmapr_event</code> function should be used. The function takes as the first argument the Iheatmap object, and as the second argument a type of event – “click”,“hover”, or “relayout”.</p>
<p>To see the output from <code>iheatmapr_event</code>, you can use the <code>shiny_test</code> function from <code>iheatmapr</code>.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/main_heatmap.html">main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_patient_cor</span>,name <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_clustering.html">add_col_clustering</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_clustering.html">add_row_clustering</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_title.html">add_row_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_title.html">add_col_title</a></span><span class="op">(</span><span class="st">"Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_row_annotation.html">add_row_annotation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Max"</span> <span class="op">=</span> <span class="va">patient_max_conc</span>,</span>
<span>                                <span class="st">"Min"</span> <span class="op">=</span> <span class="va">patient_min_conc</span>,</span>
<span>                                <span class="st">"Groups"</span> <span class="op">=</span> <span class="va">patient_groups</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_main_heatmap.html">add_main_heatmap</a></span><span class="op">(</span><span class="va">Indometh_matrix</span>,</span>
<span>                   name <span class="op">=</span> <span class="st">"Indometacin&lt;br&gt;Concentration"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_labels.html">add_col_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_title.html">add_col_title</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../../reference/add_col_summary.html">add_col_summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## NOT RUN (runs shiny app)</span></span>
<span><span class="fu"><a href="../../reference/test_iheatmapr_event.html">test_iheatmapr_event</a></span><span class="op">(</span><span class="va">hm</span>, <span class="st">"click"</span><span class="op">)</span></span></code></pre></div>
<p>To see the code for the demo shiny app:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_iheatmapr_event</span></span></code></pre></div>
<pre><code><span><span class="co">## function (ihm, event = c("click", "hover", "relayout")) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     if (!requireNamespace("shiny", quietly = TRUE)) </span></span>
<span><span class="co">##         stop("shiny not installed")</span></span>
<span><span class="co">##     event &lt;- match.arg(event)</span></span>
<span><span class="co">##     ui &lt;- shiny::fluidPage(shiny::titlePanel("iheatmapr event example"), </span></span>
<span><span class="co">##         shiny::fluidRow(shiny::column(8, iheatmaprOutput("heat")), </span></span>
<span><span class="co">##             shiny::column(4, shiny::verbatimTextOutput("cl"))))</span></span>
<span><span class="co">##     server &lt;- function(input, output) {</span></span>
<span><span class="co">##         output$heat &lt;- renderIheatmap({</span></span>
<span><span class="co">##             ihm</span></span>
<span><span class="co">##         })</span></span>
<span><span class="co">##         output$cl &lt;- shiny::renderPrint({</span></span>
<span><span class="co">##             s &lt;- iheatmapr_event(ihm, event)</span></span>
<span><span class="co">##             if (is.null(s) == TRUE) </span></span>
<span><span class="co">##                 return(paste0(event, " to see output"))</span></span>
<span><span class="co">##             utils::str(s)</span></span>
<span><span class="co">##         })</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     shiny::shinyApp(ui = ui, server = server)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x56289a492890&gt;</span></span>
<span><span class="co">## &lt;environment: namespace:iheatmapr&gt;</span></span></code></pre>
<div class="section level3">
<h3 id="deploying-on-shinyapps-io">Deploying on shinyapps.io<a class="anchor" aria-label="anchor" href="#deploying-on-shinyapps-io"></a>
</h3>
<p>An issue that has arisen in deploying to shinyapps.io is the use case of adding a download button, e.g.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not evaluated -- example output code</span></span>
<span><span class="va">output</span><span class="op">$</span><span class="va">download_test</span><span class="op">&lt;-</span><span class="fu">downloadHandler</span><span class="op">(</span></span>
<span>            filename <span class="op">=</span><span class="st">"test_heatmap.png"</span>,</span>
<span>            content <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">{</span></span>
<span>                    <span class="fu"><a href="../../reference/save_iheatmap.html">save_iheatmap</a></span><span class="op">(</span><span class="fu">heatmap_reactive</span><span class="op">(</span><span class="op">)</span>,<span class="va">file</span>,vwidth<span class="op">=</span><span class="fl">2000</span>,vheight<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span>            <span class="op">}</span>,</span>
<span>            contentType <span class="op">=</span> <span class="st">"image/png"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this case, the app needs to include the ‘webshot’ package and have phantomjs installed. With shinyapps.io that can be accomplished via</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not evaluated here -- example of what to include in app for shinyapps.io</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wch.github.io/webshot/" class="external-link">webshot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="http://wch.github.io/webshot/reference/install_phantomjs.html" class="external-link">install_phantomjs</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>With earlier versions of iheatmapr, there was also a BioC dependency, so it was necessary to specify the BioC repos in options. This can be done via <code><a href="https://rdrr.io/r/utils/setRepositories.html" class="external-link">setRepositories()</a></code>. Verifying what repositories are set can be done via <code>getOption("repos")</code>. This should no longer be needed with versions 0.5 and up of this package.</p>
</div>
<div class="section level3">
<h3 id="using-in-combination-with-plotly-r-package">Using in combination with plotly R package<a class="anchor" aria-label="anchor" href="#using-in-combination-with-plotly-r-package"></a>
</h3>
<p>Some version of this package may cause issues when used alongside the <code>plotly</code> R package as different version of the <code>plotly.js</code> library might be used. <code>iheatmapr</code> contains its own version of the <code>plotly</code> library, but as of version 0.6 you can tell it to use a different source for <code>plotly</code> via the <code>iheatmapr.plotly.source</code> option. The input to that option should be an html dependency as created by <code><a href="https://rstudio.github.io/htmltools/reference/htmlDependency.html" class="external-link">htmltools::htmlDependency</a></code>, and it can be set to pull the version of <code>plotly</code> included in the <code>plotly</code> R package via:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>iheatmapr.plotly.source <span class="op">=</span> <span class="fu">plotly</span><span class="fu">:::</span><span class="fu">plotlyMainBundle</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that this is calling an internal function within <code>plotly</code> R package and thus should be used with caution.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] reshape2_1.4.4  iheatmapr_0.7.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.4       jsonlite_1.8.8     compiler_4.3.2     Rcpp_1.0.12       </span></span>
<span><span class="co">##  [5] stringr_1.5.1      jquerylib_0.1.4    systemfonts_1.0.5  scales_1.3.0      </span></span>
<span><span class="co">##  [9] textshaping_0.3.7  yaml_2.3.8         fastmap_1.1.1      ggplot2_3.5.0     </span></span>
<span><span class="co">## [13] R6_2.5.1           plyr_1.8.9         knitr_1.45         MASS_7.3-60       </span></span>
<span><span class="co">## [17] htmlwidgets_1.6.4  tibble_3.2.1       desc_1.4.3         munsell_0.5.0     </span></span>
<span><span class="co">## [21] pillar_1.9.0       bslib_0.6.1        RColorBrewer_1.1-3 rlang_1.1.3       </span></span>
<span><span class="co">## [25] utf8_1.2.4         cachem_1.0.8       stringi_1.8.3      xfun_0.42         </span></span>
<span><span class="co">## [29] fs_1.6.3           sass_0.4.9         memoise_2.0.1      cli_3.6.2         </span></span>
<span><span class="co">## [33] pkgdown_2.0.7      magrittr_2.0.3     grid_4.3.2         digest_0.6.35     </span></span>
<span><span class="co">## [37] fastcluster_1.2.6  lifecycle_1.0.4    ggdendro_0.2.0     vctrs_0.6.5       </span></span>
<span><span class="co">## [41] evaluate_0.23      glue_1.7.0         farver_2.1.1       ragg_1.2.7        </span></span>
<span><span class="co">## [45] fansi_1.0.6        colorspace_2.1-0   rmarkdown_2.26     purrr_1.0.2       </span></span>
<span><span class="co">## [49] ellipsis_0.3.2     pkgconfig_2.0.3    tools_4.3.2        htmltools_0.5.7</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
